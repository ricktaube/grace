<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<style type="text/css" media="all">
@import "cm.css";
</style>
<title>Common Music 3</title>
</head>

<body>
<div id="content">

<h1> Common Music 3</h1>
  
<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#toolbox">Composition Toolbox</a>
  <ul>
    <li><a href="#numbers">Numbers</a></li>
    <li><a href="#lists">Lists</a></li>
    <li><a href="#mapping">Mapping and Transformation</a></li>
    <li><a href="#interpolation">Interpolation and Envelopes</a></li>
    <li><a href="#randomness">Randomness</a></li>
    <li><a href="#patterns">Patterns</a></li>
    <li><a href="#spectral">Spectral Composition</a></li>
    <li><a href="#automata">Cellular Automata</a></li>
    <li><a href="#environment">Environment</a></li>
  </ul>
  </li>

   <li><a href="#iteration">Iteration</a></li>
 
  <li><a href="#audio">Audio</a>
  <ul>
  <li><a href="#midi-out">Midi Out</a></li>
  <li><a href="#midi-in">Midi In</a></li>
  <li><a href="#clm">CLM/SndLib</a></li>
  <li><a href="#fomus">Fomus</a></li>
  <li><a href="#osc">OSC (Open Sound Control)</a></li>
  <li><a href="#csound">Csound</a></li>
  <li><a href="#plugins">Audio Plugins</a></li>

</ul>
</li>

<li><a href="#scheduler">The Scheduler</a>
<ul>

    <li><a href="#processes">Processes</a></li>
    <li><a href="#sprouting">Sprouting</a></li>
    <li><a href="#metronomes">Metronomes</a></li>  
</ul>
</li>

<li><a href="#plotting">Plotting</a></li>

<li><a href="#sal">SAL</a>
<ul>
  <li><a href="#expressions">Expressions</a></li>
  <li><a href="#assignment">Assignment</a></li>
  <li><a href="#conditionals">Conditionals</a></li>
  <li><a href="#definitions">Definitions</a></li>
  <li><a href="#files">Files</a></li>

</ul>
</li>

<li><a href="#appendix">Appendix</a>
<ul>
  <li><a href="#metasyntax">A. Documentation Meta-syntax</a></li>
  <li><a href="#funargs">B. Function Arguments</a></li>
  <li><a href="#sal_scheme_cltl">C. Table of SAL, Scheme and Common Lisp</a></li>
</ul>
</li>
<li><a href="#index">Index</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>Common Music 3 is a software environment for real time and score file (non-real time) algorithmic composition. It is implemented in <a href="http://www.rawmaterialsoftware.com/">JUCE</a>, by Julian Storer, and <a href="https://ccrma.stanford.edu/software/snd/snd/s7.html">S7 Scheme</a> / <a href="https://ccrma.stanford.edu/software/snd/snd/sndlib.html">SndLib</a>, by William Schottstaedt. 
</p>

<p> The distinguishing features of Common Music 3 (CM3)
compared with the previous (CM2) branch are: </p>

<ul>
  <li>Seamless integration of Scheme (dynamic scripting) and C++ .</li>
  <li>Audio Ports for real-time work. </li>
  <li>A dedicated scheduling thread for running <a href="#processes">processes</a> (musical algorithms) in real time.</li>
  <li>True drag-and-drop executables: all runtime sources, examples, instruments and documentation are embedded in the app itself.</li>
  <li><a href="#sal">SAL</a>, a simple, infix, minimalist language for algorithmic composition. In documentation Scheme formals are only shown when they differ in some significant way from the SAL versions. </li>
  <li>Simpler API, no object system or generic functions.</li>

  <li>Terser calling syntax to facilitate interactive coding:
  <ul>
    <li>No dependence on quoted symbols or keywords in argument data.</li>
    <li>Many functions automatically handle list mapping to reduce the need for ad hoc looping in order to process list data. (In the documentation separate formals are provided in cases where the automatic list handling results a significant difference in argument syntax.)</li>

   <li><a href="#sal:optkey-parameters">Opt/key</a> function parameters.  </li>
   <li>Shorter function names (in general).</li>
  <li>Note names in the standard chromatic scale also support quarter-tone inflection. </li>
  </ul>
</li>



</ul>

<h2 id="toolbox">Composition Toolbox</h2>

<p>The following functions have been added to Scheme to facilitate algorithmic music composition. </p>

<h3 id="numbers">Numbers</h3>

<!-- DEFINITION -->
<table class="entry" id="fit">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">fit</span>
      (<var class="arg">num</var>, <var class="arg">min</var>, <var class="arg">max</var> 
      <a href="#opt">&amp;opt</a> <var class="arg">mode</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>

<p>
Returns <var>num</var> or list of same bounded by <var>min</var> and <var>max</var> according to <var>mode</var>. If <var>min</var> &lt;= <var>num</var> &lt;= <var>max</var> then <var>num</var> is returned. Otherwise, if <var>mode</var> is 1 then the outlying <var>num</var> is wrapped between <var>min</var> and <var>max</var>, i.e. fit returns the remainder of number modulus the boundary range. If <var>mode</var> is 2, then the <var>min</var> and <var>max</var> boundaries reflect the outlying value back into range. If <var>mode</var> is 3 then the boundary value (<var>min</var> or <var>max</var>) is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="quantize">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">quantize</span>
      (<var class="arg">num</var>, <var class="arg">step</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Quantizes <var>num</var> or list of the same to be a multiple of <var>step</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="decimals">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">decimals</span>
      (<var class="arg">num</var>, <var class="arg">places</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns floating point <var>num</var> rounded to <var>places</var> fractional digits.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="plus">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="rest">num...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
    <tr class="entry">
    <td class="formals">
      <span class="funcname">plus</span>
      (<var class="arg">list</var>, <var>num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the addition of zero or more <var>nums</var>. If a single <var>list</var> of numbers is given they are summed together. Otherwise a list is returned of <var>num</var> added to every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="times">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="rest">num...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">times</span>
      (<var class="arg">list</var>, <var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the multiplication of zero or more <var>nums</var>. If a single <var>list</var> of numbers is given they are multiplied together.  Otherwise a list is returned of <var>num</var> multiplied with every element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="minus">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">num</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var class="arg">list</var>, <var>num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minus</span>
      (<var>num</var>, <var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the subtraction of one or more <var>nums</var>. If a single number is given its inverse is returned. If a single <var>list</var> of numbers is given the cumulative subtraction is returned. Otherwise a list is returned of <var>num</var> subtracted from every element in <var>list</var> or every number in <var>list</var> subtracted from <var>num</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="divide">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">divide</span>
      (<var class="arg">num</var><var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">divide</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
    </tr>

    <tr class="entry">
      <td class="formals">
        <span class="funcname">divide</span>
        (<var class="arg">list</var>, <var class="arg">num</var>)
      </td>
    </tr>

    <tr class="entry">
      <td class="formals">
        <span class="funcname">divide</span>
        (<var class="arg">num</var>, <var class="arg">list</var>)
      </td>
      <!-- td class="label">Function</td -->
    </tr>
    <tr><td class="retval">&rarr; number</td></tr>
</table>
  <blockquote>
  <p>
  Returns the division of one or more <var>nums</var>. If a single number is given its inverse is returned. If a single <var>list</var> of numbers is given the cumulative division is returned. Otherwise a list is returned of every number in <var>list</var> divided by <var>num</var> or every number in <var>list</var> divided into <var>num</var>.
  </p>
  </blockquote>
  <!-- END DEFINITION -->
  
<!-- DEFINITION -->
<table class="entry" id="mod">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mod</span>
      (<var class="rest">num1, num2</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mod</span>
      (<var class="arg">list</var>, num2)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns <var>num1</var> modulo <var>num2</var>. If a <var>list</var> of numbers is given a list of modulo are returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="minimum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minimum</span>
      (<var class="rest">num...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">minimum</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the smallest of one or more <var>nums</var>. If a <var>list</var> of numbers is given the minimum of the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="maximum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">maximum</span>
      (<var class="rest">num...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">maximum</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the larger of one or more <var>nums</var>. If a <var>list</var> of numbers is given the maximum of the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="deltas">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">deltas</span>
      (<var class="rest">num...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">deltas</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of the deltas (differences) between adjacent numbers in <var>nums</var>. The number of items returned will therefore be one less than the number of items specified to the function.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="less_qm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">less?</span>
      (<var class="arg">num</var><var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">less?</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
    </tr>
    <tr><td class="retval">&rarr; boolean</td></tr>
</table>
  <blockquote>
  <p>
  Returns true if the numbers in <var>nums...</var> or in a single <var>list</var> of numbers are in monotonically increasing order, otherwise returns false.
  </p>
  </blockquote>
<!-- END DEFINITION -->
  
<!-- DEFINITION -->
<table class="entry" id="greater_qm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">greater?</span>
      (<var class="arg">num</var><var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">greater?</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
    </tr>
    <tr><td class="retval">&rarr; boolean</td></tr>
</table>
  <blockquote>
  <p>
  Returns true if the numbers in <var>nums...</var> or in a single <var>list</var> of numbers are in monotonically decreasing order, otherwise returns false.
  </p>
  </blockquote>
  <!-- END DEFINITION -->
  
<!-- DEFINITION -->
<table class="entry" id="less_eqm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">less=?</span>
      (<var class="arg">num</var><var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">less=?</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
    </tr>
    <tr><td class="retval">&rarr; boolean</td></tr>
</table>
  <blockquote>
  <p>
  Returns true if the numbers in <var>nums...</var> or in a single <var>list</var> of numbers are in monotonically nondecreasing order, otherwise returns false.
  </p>
  </blockquote>
  <!-- END DEFINITION -->
  

<!-- DEFINITION -->
<table class="entry" id="greater_eqm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">greater=?</span>
      (<var class="arg">num</var><var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">greater=?</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
    </tr>
    <tr><td class="retval">&rarr; boolean</td></tr>
</table>
  <blockquote>
  <p>
  Returns true if the numbers in <var>nums...</var> or in a single <var>list</var> of numbers are in monotonically non-increasing order, otherwise returns false.
  </p>
  </blockquote>
<!-- END DEFINITION -->
  
<!-- DEFINITION -->
<table class="entry" id="log10">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">log10</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number </td></tr>
</table>
<blockquote>
<p>
Returns log <span style="vertical-align: middle; font-size:x-small;">10</span> of <var>num</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="log2">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">log2</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number </td></tr>
</table>
<blockquote>
<p>
Returns log <span style="vertical-align: middle; font-size:x-small;">2</span> of <var>num</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="pi">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pi</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval">&rarr; 3.141592653589793</td></tr>
</table>
<blockquote>
<p>
The value of <var>pi</var> as a double float.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="most-positive-fixnum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">most-positive-fixnum</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval">&rarr; Implementation dependent value</td></tr>
</table>
<blockquote>
<p>
The largest positive fixed point integer representable in this Lisp implementation.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="most-negative-fixnum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">most-negative-fixnum</span>
    </td>
    <!-- td class="label">Variable</td -->
  </tr>
  <tr><td class="retval">&rarr; Implementation dependent value</td></tr>
</table>
<blockquote>
<p>
The largest negative fixed point integer representable in this Lisp implementation.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="lists">Lists</h3>

<!-- DEFINITION -->
<table class="entry" id="first">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">first</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the first element in <var>list</var>. Similar accessors exist for these other common element positions:
<code id="second">second</code>,
<code id="third">third</code>,
<code id="fourth">fourth</code>,
<code id="fifth">fifth</code>,
<code id="sixth">sixth</code>,
<code id="seventh">seventh</code>,
<code id="eighth">eighth</code>,
<code id="ninth">ninth</code> and
<code id="tenth">tenth</code>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="last">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">last</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the last element in <var>list</var>. Note that this is not the same as Common Lisp's version (see <a href="#tail"><code>tail</code></a>).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="nth">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">nth</span>
      (<var class="arg">list</var>, <var class="arg">pos</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; element</td></tr>
</table>
<blockquote>
<p>
Returns the element at <var>pos</var> position (zero based) in <var>list</var>. Note that this is not the same as Common Lisp's version which (confusingly) reverses the arguments.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="butlast">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">butlast</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of all but the last element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rest">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rest</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of all but the first element in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="tail">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">tail</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the tail (last cdr) of <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<!--
<table class="entry" id="unique">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">unique</span>
      (<var class="arg">list</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Return a copy of <var>list</var> with duplicate elements removed.
</p>
</blockquote>
-->
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="concat">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">concat</span>
      (<var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Concatenates its inputs, which can be lists and non-lists, into a single list.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list-set_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-set!</span>
      (<var class="arg">list</var>, <var class="arg">pos</var>, <var class="arg">val</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; element</td></tr>
</table>

<blockquote>
<p>
Sets the element at <var>pos</var> position in <var>list</var> to <var>val</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list-intersection">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-intersection</span>
      (<var class="arg">list1</var>, <var class="arg">list2</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">test</var> <var class="optval"> = equal?</var>, <var class="arg">getter</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns the elements in <var>list1</var> that are also in <var>list2</var>. If <var>test</var> is specified it should be a function of two arguments. It is passed two elements and returns true if the values are considered the same otherwise false. If <var>getter</var> is specified it should be a function of one argument. It is passed list elements and returns the objects that the <var>test</var> function will compare.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list-union">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-union</span>
      (<var class="arg">list1</var>, <var class="arg">list2</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">test</var> <var class="optval"> = equal?</var>, <var class="arg">getter</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns elements that are in either <var>list1</var> or <var>list2</var> and with duplicate elements appearing only once. See <a href="#list-intersection">list-intersection</a> for an explanation of <var>test</var> and <var>getter</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="list-difference">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-difference</span>
      (<var class="arg">list1</var>, <var class="arg">list2</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">test</var> <var class="optval"> = equal?</var>, <var class="arg">getter</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns the elements that are in either but not both of <var>list1</var> and <var>list2</var>. See <a href="#list-intersection">list-intersection</a> for an explanation of <var>test</var> and <var>getter</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="remove-duplicates">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">remove-duplicates</span>
      (<var class="arg">list1</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">test</var> <var class="optval"> = equal?</var>, <var class="arg">getter</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns the elements of <var>list1</var> with none repeated. See <a href="#list-intersection">list-intersection</a> for an explanation of <var>test</var> and <var>getter</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="qsort_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">qsort!</span>
      (<var class="arg">sequence</var>  <a href="#opt">&amp;opt</a> <var class="arg">comparator</var> = <code>less?</code>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; sequence</td></tr>
</table>
<blockquote>
<p>
Sorts and returns <var>sequence</var> (a list or vector) given a pairwise <var>comparator</var> function. The comparator is passed pairs of values from the list and should return true if the first value is to be placed before the second value in the sorted results, otherwise false. The default comparator sorts the list in ascending order. Sorting is done "in place", that is, the sequence you pass in is destructively modified to contain the sorted results and also returned as the value of the function.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="mapping">Mapping and Transformation</h3>

<!-- DEFINITION -->
<table class="entry" id="note">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">note</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; string or list</td></tr>
</table>
<blockquote>
<p>

Returns the note (string) of <var>ref</var>, which can be a note, keynum
or list of the same. A note name consists of a pitch class letter
(<code>c</code> <code>d</code> <code>e</code> <code>f</code>
<code>g</code> <code>a</code> <code>b</code>), an optional sharp or
flat letter (<code>s</code> <code>f</code>) an optional quarter tone
inflection (<code>&lt;</code> or <code>&gt;</code>) and an octave
number (<code>00</code> to <code>9</code>). Note names can be
specified as strings, symbols or keywords. Octave numbers inside note
lists can be omitted, in which case the current note's octave defaults
to the last octave specified, or to octave 4.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="keynum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">keynum</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns the key number of <var>ref</var>, which can be a note, hertz or list of the same. A floating point key number <var>kkk.cc</var> is interpreted as the frequency <var>cc</var> cents above the integer key number <var>kkk</var>, e.g. 60.5 is 50 cents above Middle C.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="hertz">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">hertz</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns the hertz value of <var>ref</var>, which can be a note, key number or list of the same.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pitch-class">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pitch-class</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns pitch class (0-11) of <var>ref</var>, which can be a note, key number or list of the same.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rest_qm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rest?</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>ref</var> is a 'musical rest' marker (<code>r</code> or the key number -1).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="transpose">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">transpose</span>
      (<var class="arg">ref</var>, <var class="arg">amount</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Transposes <var>ref</var> by <var>amount</var>.
If <var>freq</var> and <var>amount</var> are both pitch classes then the transposition occurs in pitch class (mod 12) space. Otherwise <var>nkl</var> should be a key number, note or list of the same and it is transposed by <var>amount</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="invert">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">invert</span>
      (<var class="arg">ref</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
If <var>ref</var> is a pitch class or list of pitch classes the pitch class complement(s) are returned. Otherwise <var>nkl</var> should be a list of notes or key numbers and the (strict) inversions around the first key number or note in the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="retrograde">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">retrograde</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a version of <var>list</var> with its elements reversed.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="scale">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale</span>
      (<var class="arg">num</var>, <var class="arg">start</var>, <var class="rest">step...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale</span>
      (<var class="arg">num</var>, <var class="arg">start</var>, <var class="arg">list</var>
      <a href="#opt">&amp;opt</a>
      <var class="arg">limit</var> <var class="optval">= #f</var>, <var class="arg">mode</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of <var>num</var> key numbers starting on <var>start</var> and incremented by each <var>step</var> (positive or negative) or <var>list</var> of steps provided. If a <var>limit</var> key is provided then scale degrees will always lie between <var>start</var> and <var>limit</var> according to <var>mode</var> (see <a href="#fit"><code>fit</code></a>).


</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="scale-order">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">scale-order</span>
      (<var class="arg">list</var> <a href="#opt">&amp;opt</a> <var class="arg">mode</var> <var class="optval">= 1</var>)</td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a <var>list</var> of notes, key numbers or hertz values ordered according to <var>mode</var>, where 1 means ascending order, -1 means descending order and 0 means random order.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="rhythm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rhythm</span>
      (<var class="arg">rhy</var> <a href="#opt">&amp;opt</a> <var class="arg">tempo</var> <var class="optval">= 60</var>, <var class="arg">beat</var> <var class="optval">= 1/4</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
 Returns the value of <var>rhy</var> converted to beat units
(typically seconds) at a specified tempo. <var>Rhy</var> can be any fraction of a whole
note, a <var>rhythmic symbol</var> or a list of the same. A fraction of a whole note is simply a ratio, e.g. 1/4=quarter note, 1/8=eighth note, 3/2=three half-notes, 7/25=seven twenty-fifths notes, and so on. A rhythmic symbol consists of a metric letter (<code>w</code>=whole,<code>h</code>=half, <code>q</code>=quarter, <code>e</code>=eighth, <code>s</code>=sixteenth, <code>t</code>=thirty-second, <code>x</code>=sixty-fourth) optionally preceded by a triplet marker (<code>t</code>) and optionally followed by one or more dots (<code>.</code>). Expressions involving symbols can be formed using <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> to join the rhythmic tokens. Examples:

<code>q</code>=quarter, 
<code>tq</code>=triplet quarter, 
<code>e.</code>=dotted-eighth, 
<code>ts.</code>=triplet dotted sixteenth, 
<code>h...</code>=triple dotted half, 
<code>s+tq</code>=sixteenth plus triplet quarter, 
<code>w-ts</code>=whole minus triplet sixteenth,
<code>w*4</code>=four whole notes. 
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="in-tempo">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">in-tempo</span>
      (<var class="arg">beats</var>, <var class="arg">tempo</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>Scales a  <var>beat</var> value by a metronome <var>tempo</var> value: <var>beats</var>*(60/<var>tempo</var>)
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rescale">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rescale</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>,  <var class="arg">x2</var>, <var class="arg">y1</var>, <var class="arg">y2</var>
      <a href="#opt">&amp;opt</a> <var class="arg">base</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>

<blockquote>
<p>Returns a floating point value between <var>y1</var> and <var>y2</var> that is proportional to a floating point <var>x</var> or list of the same lying between <var>x1</var> and <var>x2</var>. If <var>base</var> is 1 the rescaling is linear otherwise its exponential where <var>base</var> &gt; 1 produce increasing spread as <var>x</var> approaches <var>x2</var> and values  &lt; 1 produce decreasing spread.</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="discrete">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">discrete</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>, <var class="arg">x2</var>, <var class="arg">i1</var>, <var class="arg">i2</var>,
     <a href="#opt">&amp;opt</a> <var class="arg">base</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">discrete</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>, <var class="arg">x2</var>, <var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>  <tr><td class="retval">&rarr; integer, element or list</td></tr>
</table>
<blockquote>
<p>
Similar to <code>rescale</code> except floating point <var>x</var> is mapped onto integer values between <var>i1</var> and <var>i2</var>, or onto the elements in <var>list</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="segs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">segs</span>
      (<var class="arg">num</var>, <var class="arg">sum</var>
      <a href="#opt">&amp;opt</a>
      <var class="arg">mode</var> <var class="optval">= 1</var>, <var class="arg">base</var> <var class="optval">= 2</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>

  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns <var>num</var> segments adding up to <var>sum</var>, where the relationship between each segment is determined by <var>mode</var>. If <var>mode</var> is 1 then the segments are exponentially related, where <var>base</var> values greater than 1 produce exponentially increasing segments, and reciprocals produce exponentially decreasing segments. If <var>mode</var> is 2 then the segments returned are related by the <a href="http://en.wikipedia.org/wiki/Geometric_series">geometric series</a>. If <var>mode</var> is 3 then random segments that add up to <var>sum</var> are returned.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="ratio-_cents">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ratio-&gt;cents</span>
      (<var class="arg">scaler</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a frequency ratio <var>scaler</var> or list of the same to the equivalent in cents.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ratio-_steps">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ratio-&gt;steps</span>
      (<var class="arg">scaler</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a frequency ratio <var>scaler</var> or list of the same to the equivalent in half-steps.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="cents-_ratio">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">cents-&gt;ratio</span>
      (<var class="arg">cents</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Converts a <var>cent</var> value or list of the same to the equivalent frequency scaler.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="harmonics">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">harmonics</span>
      (<var class="arg">h1</var>, <var class="arg">h2</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">fund</var> <var class="optval">= 1</var>,
      <var class="arg">invert</var> <var class="optval">= #f</var>,
      <var class="arg">order</var> <var class="optval">= #f</var>,
      <var class="arg">keys</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of ratios, hertz values, or key numbers based on the harmonic series between the harmonic numbers <var>h1</var> and <var>h2</var> inclusive. If 0 &lt; <var>h1</var> &lt; <var>h2</var> then values will belong to the overtone series, otherwise if 0 &gt; <var>h1</var> &gt; <var>h2</var> then values will belong to the "undertone" series. If <var>fund</var> is 1 then the values returned will be frequency ratios, otherwise the series will be based on that hertz value. If <var>invert</var> is true then the ratios between <var>h1</var> and <var>h2</var> are reciprocals, i.e. "flipped". If <var>order</var> is false then the overtone series are in increasing order and undertones are in decreasing order. Otherwise, if <var>order</var> is 1 then the list is always ascending, if it is -1 the list always descending, and if it is 0 the list order is randomized. If <var>keys</var> is true then the values returned will be coerced to key numbers.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="golden">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">golden</span>
      (<var class="arg">num1</var>, <var class="arg">num2</var> <a href="#opt">&amp;opt</a> <var class="arg">inv?</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>Returns the golden mean between <var>num1</var> and <var>num2</var>. If <var>inv?</var> is true the inverse of the golden mean is used.</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="fibonacci">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">fibonacci</span>
      (<var class="arg">nth</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>

<blockquote>
<p>Returns the <var>nth</var> number in the fibonacci series.</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="interpolation">Interpolation and Envelopes</h3>

<p>
The following functions provide linear and exponential interpolation using break-point envelopes. A break-point envelope is a list of x and y values: {<var> x<sub>1</sub> y<sub>1</sub> x<sub>2</sub> y<sub>2</sub> ... x<sub>n</sub> y<sub>n</sub></var>}  where x values are the monotonically increasing domain values and y values are the range.
</p>

<!-- DEFINITION -->
<table class="entry" id="interp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">interp</span>
      (<var class="arg">x</var>, <var class="arg">x1</var>,  <var class="arg">y1</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">interp</span>
      (<var class="arg">x</var>, <var class="arg">list</var>
      <a href="#opt">&amp;opt</a> <var class="arg">base</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>

<p>
Returns the interpolated y value of <var>x</var> in a series of <var>x1 y1 ...</var> coordinate pairs a break-point envelope list of the same. If the coordinates are specified as a list then an optional <var>base</var> can control the type of interpolation (linear or exponential) used. See <a href="#rescale"><code>rescale</code></a> for more information.
</p>

</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="read-envelope">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">read-envelope</span>
      (<var class="arg">env</var>, <var class="arg">num</var> <a href="#opt">&amp;opt</a> <var class="arg">control</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Reads <var>num</var> values from the bread-point envelope <var>env</var> and returns them in a list. If <var>control</var> is #f then num equally-spaced samples are returned. Otherwise <var>control</var> is a normalized envelope that controls the motion of the read postion along the x axis of the envelope with the x axis of the control envelope expressing the ratio of each sample position i to the total number: i/num. The y axis of the control should be thought of as how far into the sampled envelope to read. Thus, a control of {0 0 1 .5} will read from the beginning of the envelope to half-way through over the course of num readings and a control with an upward slope moves the pointer along the x axis linearly from the beginning to the end.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="interp-envelopes">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">interp-envelopes</span>
      (<var class="arg">env0</var> , <var class="arg">env1</var> , <var class="arg">num </var>, <var class="arg">weight</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Interpolates values between two envelopes <var>env0</var> and <var>env1,</var> allowing "morphing" from one envelope to the other. The third argument <var>num</var> is the number of values to read from the envelopes.  The <var>weight</var> argument determines the relative influence each envelope contributes on the values returned. A <var>weight</var> of 0 will pass only values from the first envelope, a value of 1 will pass only values from the second envelope, and a value in beween 0 and 1 will pass a weighted sum of the two envelopes. The <var>weight</var> can also be expressed as break point envelope so the porportional weight can change dynamically over num reads.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="tendency">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">tendency</span>
      (<var class="arg">x</var>, <var class="arg">low</var>, <var class="arg">high</var> <a href="#opt">&amp;opt</a>  <var class="arg">gen</var> <var class="optval">= <a href="#ran">ran</a></var>, <var class="rest">args...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Returns a random lying between the values of <var>x</var> in the <var>low</var> and <var>high</var> envelopes. If <var>low</var> or <var>high</var> are constant for any <var>x</var> they may be numbers rather than envelopes. <var>Gen</var> is an optional random function that will be applied to <var>args...</var> to generate the random number between <var>low</var> and <var>high</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="list-_envelope">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">list-&gt;envelope</span>
      (<var class="arg">vals</var> <a href="#optkey">&amp;optkey</a> <var class="arg">x0</var> <var class="optval">= 0</var>, <var class="arg">x1</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns an envelope given a list of <var>vals</var> containing y values. <var>x0</var> and <var>x1</var> are the minimum and maximum values for the x axis, and default to 0 and 1, respectively.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="envelope-_list">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">envelope-&gt;list</span>
      (<var class="arg">env</var>, <a href="#opt">&amp;opt;</a> <var class="arg">coord</var> <var class="optval">= :y</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of :x or :y coordinate values from the specified break-point envelope <var>env</var>, defaults to :y.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="envelope-min">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">envelope-min</span>
      (<var class="arg">env</var> <a href="#opt">&amp;opt</a> <var class="arg">coord</var> <var class="optval">= :y</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the smallest :x or :y coordinate value from the specified break-point envelope <var>env</var>, defaults to :y.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="envelope-max">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">envelope-max</span>
      (<var class="arg">env</var> <a href="#opt">&amp;opt</a> <var class="arg">coord</var> <var class="optval">= :y</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the largest envelope value of the specified coordinate, defaults to :y.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="envelope-average">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">envelope-average </span>
      (<var class="arg">env</var> <a href="#opt">&amp;opt</a>, <var class="arg">coord</var> <var class="optval">= :y</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the average envelope value of the specified coordinate, defaults to :y.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="normalize-envelope">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">normalize-envelope</span>
      (<var class="arg">env</var> <a href="#opt">&amp;opt</a> <var class="arg">coord</var> <var class="optval">= #t</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns envelope normalized to lie between 0 and 1. If <var>coord</var> is #t (the default) then that both x and y coordinates are normalized, otherwise specify :x or :y as the coordinate to normalize.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="invert-envelope">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">invert-envelope</span>
      (<var class="arg">env</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Inverts the shape of the specified envelope vertically along the y axis.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="reverse-envelope">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">reverse-envelope</span>
      (<var class="arg">env</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Reverses the envelope shape horizonally along the x axis.
</p>
</blockquote>
<!-- END DEFINITION -->


<h3 id="randomness">Randomness</h3>

<p>
All functions that perform random selection use a common random number generator whose current seed can be acquired or set using <a href="#random-seed"><code>random-seed</code></a>.  Reseeding the random generator will cause the random number generator to repeat the same sequence of numbers based on that seed.
</p>

<h4>Uniform Distribution</h4>

<!-- DEFINITION -->
<table class="entry" id="ran">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">random</span>
      (<var class="arg">num</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns a random number between 0 and <var>num</var> (exclusive). If <var>num</var> is an integer then an integer will be returned otherwise a floating point value is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="between">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">between</span>
      (<var class="arg">a</var>, <var class="arg">b</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns a randomly chosen number between <var>a</var> and <var>b</var> (exclusive). The value of  <var>b</var> can be less than <var>a</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="vary">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">vary</span>
      (<var class="arg">value</var>, <var class="arg">pct</var>
      <a href="#opt">&amp;opt</a> <var class="arg">mode</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number or list</td></tr>
</table>
<blockquote>
<p>
Returns a random number that deviates from <var>value</var> or list of
the same by up to <var>pct</var> (1=100%) according to
<var>mode</var>. If <var>mode</var> is 0 then <var>value</var> is at
the center of what could be returned.  If <var>mode</var> is -1 then
<var>value</var> is the maximum possible value, otherwise
<var>mode</var> 1 places <var>value</var> at the minimum of what could
be returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="drunk" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">drunk</span>
      (<var class="arg">num</var>, <var class="arg">width</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">low</var> <var class="optval">= #f</var>, <var class="arg">high</var> <var class="optval">= #f</var>, <var class="arg">mode</var> <var class="optval">= #f</var> <var class="arg">avoid</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns a random value constrained to lie between <var>num - width</var> and <var>num + width</var>. Calling the function and passing the previous value of <var>num</var> implements a random walk (see also <a href="#ranbrown">ranbrown</a>). If <var>low</var> and <var>high</var> are provided they specify lower and upper bounds on the value returned. If the value exceeds either limit then the <var>mode</var> determines how the out-of-bounds value is handled. Possible values for <var>mode</var> are:
</p>

<ul>
  <li>-1 or <span class="keyword">:reflect</span>, value is reflected back into bounds</li>
  <li>0 or <span class="keyword">:stop</span>, returns false as value of function</li>
  <li>1 or <span class="keyword">:limit</span>, nearest boundary value is returned</li>
  <li>2 or <span class="keyword">:reset</span>, value is centered between boundaries</li>
  <li>3 or <span class="keyword">:jump</span>, value randomly selected between boundaries</li>
</ul>

<p>
If <var>avoid</var> is a value between -width and width then random value chosen will never be equal to it.
</p>

</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="odds">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">odds</span>
      (<var class="arg">num</var> <a href="#opt">&amp;opt</a> <var class="arg">true</var> <var class="optval">= #t</var>, <var class="arg">false</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; value</td></tr>
</table>
<blockquote>
<p>
Returns <var>true</var> value if a randomly chosen number between 0.0 and 1.0 is less than <var>num</var> else returns <var>false</var> value.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="pick">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pick</span>
      (<var class="rest">arg...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pick</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; value</td></tr>
</table>
<blockquote>
<p>
Returns a randomly selected <var>arg</var> as the value of the function. If just one argument is given it should be a <var>list</var> and a randomly selected value from the list is returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="shuffle">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle</span>
      (<var class="arg">args...</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a version of <var>args...</var> or a <var>list</var> of the same with the elements randomly reordered.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="shuffle_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shuffle!</span>
      (<var class="arg">list</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Like <a href="#shuffle"><code>shuffle</code></a> except that <var>list</var> is destructively modified by the random reordering.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="random-series">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">random-series</span>
      (<var class="arg">num</var>, <var class="arg">low</var>, <var class="arg">high</var>
      <a href="#opt">&amp;optkey</a>
      <var class="arg">series</var> <var class="optval"> = {}</var>,
      <var class="arg">reject</var> <var class="optval"> = #f</var>,
      <var class="arg">order</var> <var class="optval"> = #f</var>,
      <var class="arg">chooser</var> <var class="optval"> = random</var>
      )
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of <var>num</var> random values between <var>low</var> and <var>high</var> (exclusive). If <var>series</var> is specified it is the initial contents of the series to be returned by the function. By default values  between <var>low</var> and <var>high</var> are randomly chosen and added to the series. If a <var>reject</var> function is specified it is passed candidate values and the series so far and if it returns true the value will not be added to the series (else it will be added). If a <var>sorter</var> function is specified it is passed two values and it returns true if the first value should appear before the second in the series returned by the function. If a <var>chooser</var> function is specified it is used as the random number generator. It is passed the range <var>high-low</var> and should return a number between 0 and <var>range-1</var>.
</p>
</blockquote>
<!-- END DEFINITION -->


<h4>Nonuniform Distributions</h4>

<!-- DEFINITION -->
<table class="entry" id="ranpink">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranpink</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a pinkish  (1/f)  value between -1 and 1.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranbrown">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranbrown</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a brownish  (1/f<sup>2</sup>) value between -1 and 1.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranlow">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranlow</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with lower values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranhigh">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranhigh</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with higher values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranmiddle">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranmiddle</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value between 0 and 1 with middle values more likely.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rangauss">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rangauss</span>
      (<a href="#opt">&amp;opt</a>  <var class="arg">a</var> <var class="optval">= 1</var>, <var class="arg">b</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns unbounded value from the  <a href="http://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> with standard deviation <var>a</var> (sigma) and mean <var>b</var> (mu).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranexp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranexp</span>
      (<a href="#opt">&amp;opt</a>  <var class="arg">lambda</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a value greater than 0 from the  <a href="http://en.wikipedia.org/wiki/Exponential_distribution">exponential distribution</a> with stretching factor <var>lambda</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranbeta">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranbeta</span>
      (<a href="#opt">&amp;opt</a>  <var class="arg">a</var> <var class="optval">= .5</var>, <var class="arg">b</var> <var class="optval">= .5</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns value between 0 and 1 from the  <a href="http://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rangamma">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rangamma</span>
      (<a href="#opt">&amp;opt</a> <var class="arg">k</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns value greater than 0 from the  <a href="http://en.wikipedia.org/wiki/Gamma_distribution">gamma distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rancauchy">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rancauchy</span>
      ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns an unbounded value from the <a href="http://en.wikipedia.org/wiki/Cauchy_distribution">Cauchy distribution</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="ranpoisson">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">ranpoisson</span>
      (<a href="#opt">&amp;opt</a> <var class="arg">lambda</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns an unbounded integer value from the <a href="http://en.wikipedia.org/wiki/Poisson_distribution">Poisson distribution</a> with shape factor <var>lambda</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4>Seeding</h4>

<!-- DEFINITION -->
<table class="entry" id="random-seed">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">random-seed</span>
      (<a href="#opt">&amp;opt</a> <var class="arg">seed</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns or sets the current seed used by the random number generator. If <var>seed</var> is specified it should be a single integer or an actual <var>seed list</var> that was returned by this function. Reseeding the generator with a saved seed list will regenerate the identical series of random numbers that the seed originally produced.
</p>
</blockquote>
<!-- END DEFINITION -->


<h3 id="patterns">Patterns</h3>

<p>
Patterns are objects that generate data in different orderings. Data can be constants (numbers, symbols, lists, etc), sub-patterns, or thunks (functions of zero arguments). Use <a href="#next"><code>next</code></a> to return the next value from a pattern; constant data are simply returned from the pattern, sub-patterns produce local orderings within the larger pattern and thunks are called to produce data.
</p>

<div class="float" id="table_1">
<table>
<tr><th class="lcol">Pattern</th><th class="lcol">Description</th></tr>
<tr><td><a href="#make-cycle">Cycle</a> </td><td>generates its elements in a continuous loop</td></tr>
<tr><td><a href="#make-line">Line</a></td><td>generates its elements sequentially and sticks on last element</td></tr>
<tr><td><a href="#make-heap">Heap</a></td><td>generates random permutations of its elements</td></tr>
<tr><td><a href="#make-palindrome">Palindrome</a></td><td>generates its elements forwards and backwards</td></tr>
<tr><td><a href="#make-rotation">Rotation</a></td><td>generates systematic permutations of its elements</td></tr>
<tr><td><a href="#make-weighting">Weighting</a></td><td>generates elements from a weighted random distribution</td></tr>
<tr><td><a href="#make-markov">Markov</a></td><td>generates nth order Markov chains of its elements</td></tr>
<tr><td><a href="#make-graph">Graph</a></td><td>generates elements from a directed graph</td></tr>
<tr><td><a href="#make-repeater">Repeater</a></td><td>repeats data generated by a pattern</td></tr>
</table>
</div>

<!-- DEFINITION -->
<table class="entry" id="make-cycle">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">make-cycle</span>
      (<var class="arg">items</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its elements in a continual loop.  <var>Items</var> is the list of data to generate and can include sub-patterns.  <var>For</var> sets the number of internal reads that will make up the next period, or chunk, of data returned from the pattern. This value can be a number or pattern of numbers and defaults to the length of <var>items</var>.  <var>Limit</var> sets an optional limit on the number of periods that the pattern will generate; once this limit has been reached the pattern returns an <a href="#eod_">end of data</a> marker instead of data.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-line">
  <tr class="entry">
    <td class="formals">
      <span class="term">make-line</span>
      (<var class="arg">items</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates <var>items</var> sequentially and sticks on the last item.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-heap">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-heap</span>
    (<var class="arg">items</var>
    <a href="#optkey">&amp;optkey</a>
    <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Generates random permutations of its <var>items</var>  (sampling without replacement). 
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-palindrome">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-palindrome</span>
    (<var class="arg">items</var>
    <a href="#optkey">&amp;optkey</a>
    <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>, <var class="arg">elide</var> <var class="optval"> = #f</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates <var>items</var> forwards and backwards. <var>Elide</var> determines what happens to the first and last items when the pattern reverses itself. If the value is false then these items are repeated. If the value is true then neither item is directly repeated. Otherwise the value can should be a two element list {<var>bool</var> <var>bool</var>} specifying the repeat value for the first and last item.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-weighting">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-weighting</span>
    (<var class="arg">items</var>
    <a href="#optkey">&amp;optkey</a>
    <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>  
<blockquote>
<p>
Returns a weighting pattern that generates <var>items</var> from a weighted distribution.
Each item can be an item, sub-pattern, or list:
</p>
<blockquote>
  <p><code>{<var>item</var> <span class="meta">[</span><var>weight 1</var><span class="meta">]</span> <span class="meta">[</span><var>min 1</var><span class="meta">]</span> <span class="meta">[</span><var>max #f</var><span class="meta">]</span>}</code></p>
</blockquote>
<p>
where <var>item</var> is the thing to generate, <var>weight</var> is its weight in the distribution relative to the other items in the pattern, <var>min</var> is the minimum number of times that <var>item</var> must be directly selected before another item can be considered, and <var>max</var> is the maximum number of times that <var>item</var> can be directly selected before another item must be selected.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-rotation">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">make-rotation</span>
      (<var class="arg">items</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>, <var class="arg">rotate</var> <var class="optval"> = {0}</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that rotates its items according to <var>rotate</var>, which can be a list or a pattern of lists of the format:
</p>
<blockquote>
  <p><code>{<var>start</var> <span class="meta">[</span><var>step 1</var><span class="meta">]</span> <span class="meta">[</span><var>width 1</var><span class="meta">]</span> <span class="meta">[</span><var>end</var><span class="meta">]</span>}</code></p>
</blockquote>
</blockquote>
<!-- END DEFINITION -->
  
<!-- DEFINITION -->
<table class="entry" id="make-markov">
  <tr class="entry">
  <td class="formals">
    <span class="funcname">make-markov</span>
    (<var class="arg">items</var>
    <a href="#optkey">&amp;optkey</a>
    <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>, <var class="arg">past </var> <var class="optval"> = {}</var>)
  </td>
  <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its items according to (nth order) transitions lists:
</p>
<blockquote>
  <p><code>{<var>past ...</var> -&gt; {<var>next weight</var>} <var>...</var>}</code></p>
</blockquote>
<p>
Items appearing before <code>-&gt;</code> in the rule are the past choice(s) that trigger the transition and items following <code>-&gt;</code> make up the weighted distribution determining the transition's next outcome. If <var>past</var> it supplied it will be the initial past choices to match the transitions against, otherwise the first transition rule is used.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="markov-analyze" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">markov-analyze</span>
      (<var class="arg">list</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">order</var> = <var class="optval">1</var>, <var class="arg">mode</var> = <var class="optval">1</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; void, pattern or list</td></tr>
</table>
<blockquote>
<p>
Analyzes a <var>list</var> of data for a specified Markov <var>order</var> (0-n) and computes a table capturing the Markov transitions rules that generates a version <var>data</var> for the supplied <var>order</var>. Returns results according to <var>mode</var>. If <var>mode</var> is 1 then the transition table is printed in an easy to read row and column format. If mode is 2 then a <a href="#make-markov">markov pattern</a> containing the table is returned. If <var>mode</var> is 3 then the table is returned as a list of items suitable for passing to <a href="#make-markov"><code>make-markov</code></a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-graph">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-graph</span>
      (<var class="arg">items</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">for</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a pattern that generates its items from a directed graph of nodes with transition patterns. Each node is a list:
</p>
<blockquote>
  <p><code>{<var>item</var> <var>to</var> <span class="meta">[</span><var>id</var><span class="meta">]</span>}</code></p>
</blockquote>
<p>
where <var>item</var> is the item or pattern to generate, <var>to</var> is an id or pattern of ids identifying which node should follow the current node in the graph, and <var>id</var> is a unique identifier for the node which defaults to the node's position in <var>items</var> starting from 1.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="make-repeater">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-repeater</span>
      (<var class="arg">pattern</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">for</var> <var class="optval"> = 1</var>, <var class="arg">repeat</var> <var class="optval"> = #f</var>, <var class="arg">limit</var> <var class="optval"> = #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; pattern</td></tr>
</table>
<blockquote>
<p>
Returns a specialized pattern that repeats periods of data generated from a specified pattern. <var>For</var> specifies how may elements of data will constitute one period of elements returned by the repeater. The total number of elements in the repeater's period will be equal to this value times the number of elements returned by the pattern. Alternately, <var>repeat</var> specifies how many times each period will be repeated before a new period is generated. The <var>repeat</var> initialization causes the <var>for</var> initialization to be ignored.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="next">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">next</span>
      (<var class="arg">pattern</var> <a href="#opt">&amp;opt</a>  <var class="arg">chunk</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; element or list</td></tr>
</table>
<blockquote>
<p>
Returns one or more elements from <var>pattern</var> according to <var>chunk</var>. If <var>chunk</var> is false then the next element from <var>pattern</var> is returned. If <var>chunk</var> is a number then that many elements are read from the pattern and returned in a list. Otherwise if <var>chunk</var> is true then the next period's worth of data is returned in a list.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="eop_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">eop?</span>
      (<var class="arg">pattern</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; boolean</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>pattern</var> is at the end of its current period. <var>Pattern</var> can be a pattern or the value returned from the pattern by <a href="#next">next</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="eod_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">eod?</span>
      (<var class="arg">pattern</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; boolean</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>pattern</var> is at the end of its data.  This condition can only happen if the pattern was created with a <var>repeat</var> value explicitly provided. <var>Pattern</var> can be a pattern or the value returned from the pattern by <a href="#next">next</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="promise">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">promise</span>
      (<var class="arg">expr</var>)
    </td>
    <!-- td class="label">Macro</td -->
  </tr>
  <tr><td class="retval">&rarr; function</td></tr>
</table>
<blockquote>
<p>
Turns <var>expr</var> into a function of zero arguments that, when called, returns the value of <var>expr</var>. Use promise to embed expressions in pattern data, when a promise is read by <a href="#next"><code>next</code></a> the value it returns becomes the value of next.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="spectral">Spectral Composition</h3>

<p>
The following functions create, access or modify <var>spectrum</var> objects. A spectrum holds a sequence of frequencies, an (optional) sequence of amplitudes and an (optional) time value. A spectrum can be sent to and from plotter displays for graphic editing and converted to other representations, for example to lists of notes and key numbers.
</p>

<h4>Creating Spectra</h4>

<!-- DEFINITION -->
<!--
<table class="entry" id="make-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-spectrum</span>
      (<var class="arg">freqs</var> <a href="#optkey">&amp;optkey</a> <var class="arg">amps</var> <var class="optval">= #f</var>, <var class="arg">time</var> <var class="optval">= #f</var>)
    </td>

  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Creates a spectrum out of the specified <var>freqs</var> (list of hertz values) an optional list of <var>amps</var> and an optional <var>time</var>.
</p>
</blockquote>
-->
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="fm-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">fm-spectrum</span>
      (<var class="arg">carrier</var>, <var class="arg">ratio</var>, <var class="arg">index</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a spectrum generated by <a href="http://en.wikipedia.org/wiki/Frequency_modulation_synthesis">Frequency Modulation</a> given a <var>carrier</var>  in hertz, a modulation <var>ratio</var> and an fm <var>index</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="rm-spectrum">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">rm-spectrum</span>  (<var class="arg">freq1</var>, <var class="arg">freq2</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a spectrum generated by <a href="http://en.wikipedia.org/wiki/Ring_modulation">ring modulation</a>, where <var>freq1</var> and <var>freq2</var> can be spectrum objects, lists of hertz values or single hertz values.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="sdif-import">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sdif-import</span>
      (<var class="arg">file</var>
      <a href="#opt">&amp;opt</a>  <var class="arg">type</var> <var class="optval"> = #f</var>
      )
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Imports <a href="http://sdif.sourceforge.net/">SDIF</a> <var>file</var> as a list of frame data. If <var>type</var> is not specified all frames in the file will be imported, otherwise <var>type</var> should be a valid SDIF frame type (a four character string, symbol or keyword, e.g. <span class="string">"1TCR"</span>) in which case only frames of that type will be imported.  The data returned is a list of frames, where each frame contains an SDIF type, time and one or more matrixes:
</p>
<blockquote><p><code>(<var>type</var> <var>time</var> <var>matrix</var> ...)</code></p></blockquote>
<p>
and each matrix in a frame is a list containing a matix type and one or more rows of data:
</p>
<blockquote><p><code>(<var>type</var> <var>row</var> ...)</code></p></blockquote>
<p>
and each row in a matrix is a list of one or more values:
</p>
<blockquote><p><code>(val ...)</code></p></blockquote>

</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="sdif-import-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sdif-import-spectra</span>
      (<var class="arg">file</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Imports <a href="http://sdif.sourceforge.net/standard/sdif-standard.html">SDIF</a> "1TCR" frame data in <var>file</var> as a list of <a href="#spectrum">spectrum</a> objects.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="spear-import-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spear-import-spectra</span>
      (<var class="arg">file</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Imports <a href="http://www.klingbeil.com/spear/">SPEAR</a> frame data in <var>file</var> as a list of <a href="#spectrum">spectrum</a> objects.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spear-export-spectra">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spear-export-spectra</span>
      (<var class="arg">spectra</var>, <var class="arg">file</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Exports on or more spectrum objects in <var>spectra</var> to a file suitable for importing into <a href="http://www.klingbeil.com/spear/">SPEAR</a>. Since spectra do not have partials.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="spectrum-copy">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-copy</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Returns a copy of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4 id="spectrum">Accessing Spectral Information</h4>

<!-- DEFINITION -->
<table class="entry" id="spectrum-size">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-size</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; integer</td></tr>
</table>
<blockquote>
<p>
Returns the number of frequency and amplitude pairs in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-time">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-time</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float or #f</td></tr>
</table>
<blockquote>
<p>
Returns the time of <var>spectrum</var> or false if there is none.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-maxfreq">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-maxfreq</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the highest frequency in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-minfreq">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-minfreq</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the lowest frequency in <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-maxamp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-maxamp</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the highest amplitude in <var>spectrum</var> or 0.0 if there are no amplitudes.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-minamp">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-minamp</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the lowest amplitude in <var>spectrum</var> or 0.0 if there are no amplitudes.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-freqs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-freqs</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the frequency values of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-amps">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-amps</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns the amplitude values of <var>spectrum</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-pairs">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-pairs</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list containing the frequencies and amplitudes of <var>spectrum</var> formatted as pairs: <code>(</code><var>f<sub>1</sub> a<sub>1</sub> ... f<sub>n</sub> a<sub>n</sub></var><code>)</code>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4>Modifying and Transforming Spectral Information</h4>

<!-- DEFINITION -->
<table class="entry" id="spectrum-keys">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-keys</span>
      (<var class="arg">spectrum</var> <a href="#optkey">&amp;optkey</a> <var class="arg">order</var> <var class="optval">= 1</var>, <var class="arg">thresh</var> <var class="optval">= 0.0</var>, <var class="arg">quant</var> <var class="optval">= #f</var>, <var class="arg">unique</var> <var class="optval">= #f</var>, <var class="arg">min</var> <var class="optval">= #f</var>, <var class="arg">max</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of the frequency components of <var>spectrum</var> converted to <a href="#keynum">key numbers</a>.  <var>Order</var> specifies the <a href="#scale-order">scale order</a> the keys will be returned in. <var>Threshold</var> specifies the minimum amplitude that frequencies must possess in order to be returned as keys. If <var>threshold</var> is a list <code>(</code><var>min</var> <var>max</var><code>)</code> then components whose amplitudes are greater than max are also suppressed. If <var>quant</var> is a number between 0.0 and 1.0 then key numbers are quantized to that fractional cent value, e.g. <var>quant</var> .5 returns key numbers quantized to the nearest quarter-tone and <var>quant</var> 1 returns key numbers rounded to the nearest integer. If <var>unique</var> is true then no duplicate key numbers will be returned.  If a <var>min</var> key number is specified then spectral values lower than that will be octave shifted upward until they equal or exceed it. If a <var>max</var> key number is specified then spectral components above it will be octave shifted downward until they are equal to or lower than it.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-add_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-add!</span>
      (<var class="arg">spectrum</var>, <var class="arg">freq</var>, <var class="arg">amp</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Adds a pair of <var>freq</var> and <var>amp</var> values into <var>spectrum</var>. If <var>freq</var> already exists in <var>spectrum</var> then <var>amp</var> is added to its current amplitude.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-flip_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-flip!</span>
      (<var class="arg">spectrum</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Inverts the frequencies in <var>spectrum</var> while preserving the minimum and maximum frequency boundaries.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="spectrum-invert_">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">spectrum-invert!</span>
      (<var class="arg">spectrum</var> <a href="#optkey">&amp;optkey</a> <var class="arg">point</var> = #f)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; spectrum</td></tr>
</table>
<blockquote>
<p>
Inverts frequencies in <var>spectrum</var> around <var>point</var>, or around the first partial if <var>point</var> is false. 
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="automata">Cellular Automata</h3>

<!-- DEFINITION -->
<table class="entry" id="make-automata">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-automata</span> (<var class="arg">cells</var>, <var class="arg">transfunc</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">title</var> <var class="optval">= #f</var>,
      <var class="arg">colormap</var> <var class="optval">= {}</var>,
      <var class="arg">backgroundcolor</var> = <span class="string">"white"</span>,
      <var class="arg">cellsize</var> <var class="optval">= 50</var>,
      <var class="arg">cellbordersize</var> <var class="optval">= 1</var>,
      <var class="arg">rows</var> <var class="optval">= 1</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval">&rarr; automata</td></tr>
</table>
<blockquote>
<p>
Creates a cellular automata containing the specified initial integer <var>cellstates</var> and using the transition function <var>transfunc</var> to produce all subsequent states for cells in the automata.  For 2D automata <var>cellstates</var> is a list of lists where each sublist defines a row of initial states.
</p>

<p>
The transition function <var>transfunc</var> is called automatically and passed two arguments, the automata and the index of the current cell, and must return the next state of the cell at index. Inside the transition function you can use the function <a href="#cell-state"><code>cell-state</code></a> to access the current state of any cell in the automata.
</p>

<p>
To associate a graphical window with an automata provide the optional <var>window</var> and <var>colormap</var> arguments, where <var>window</var> is the title (string) of the new window and <var>colormap</var> is a list of state and color pairs: (<var>state1 color1 state2 color2 ... stateN colorN</var>). Note that an error is signaled if <var>window</var> is already open, and that the color map must contain all possible states of the automata along with their colors in the window. Colors are symbols or strings, the list of all colors is available in the globals <code>*colors*</code> variable. The <var>backgroundcolor</var> argument is a string or symbol naming the background color for the window. The <var>cellsize</var> argument is the size in pixels of each cell in the state window display. The <var>cellbordersize</var> argument is the size in pixels of space between each cell in the state window. The <var>rows</var> argument applies to 1-dimensional automata only, and specifies the number of successive generations to display in the window, where each generation is shown as a cell "row".
</p>

<p>
Once an automata has been created use <a href="#state"><code>state</code></a> to read successive states from it.
</p>

<p>
See the <span class="menuitem">Help&gt;Examples&gt;Cellular Automata</span> menu for <a href="automata.scm">examples of using cellular automata</a>.
</p>
</blockquote>

<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="state">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">state</span> (<var class="arg">automata</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">all</var> = #f)
    </td>
  </tr>
  <tr><td class="retval">&rarr; integer or list</td></tr>
</table>
<blockquote>
<p>
Return the next integer state from <var>automata</var> or a list of all the states in the current generation if <var>all</var> is true.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="cell-state">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">cell-state</span> (<var class="arg">automata</var>, <var class="arg">index</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">neighbor</var> = 0)
    </td>
  </tr>

  <tr><td class="retval">&rarr; integer</td></tr>
</table>
<blockquote>
<p>
Returns the current integer state of the <var>automata</var> cell at <var>index</var>. If neighboring cells to <var>index</var> must be accessed provide a positive or negative <var>neighbor</var> increment to <var>index</var> . Cell addresses are always accessed mod the size of the cell array so you do not have to perform bounds checking when you specify a neighbor increment. For 2D automata each <var>index</var> and <var>neighbor</var> is a two dimensional <code>xy</code> point. You specify 2D points and 2D increments using the <a href="#xy"><code>xy</code></a> function, i.e. <code>(cell-state index (xy -1 -1))</code> would access the value of the north-west neighbor of the  cell at index in a 2D automata.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="xy">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">xy</span> (<var class="arg">x</var>, <var class="arg">y</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; integer</td></tr>
</table>
<blockquote>
<p>
Encodes <var>x</var> and <var>y</var> values -+2768 as a single point (integer) value.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="environment">Environment</h3>

<!-- DEFINITION -->
<table class="entry" id="print">
 <tr class="entry">
    <td class="formals">
      <span class="funcname">print</span> (<var class="arg">expr</var> <span class="meta">{</span>, <var class="arg">expr</var><span class="meta">}*</span>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p> Prints one or more <a href="#expressions">expressions </a> to the Console window.</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="now">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">now</span>
      ()
    </td>
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns a current time stamp. Note that now values are not used by the scheduler or in processes, which have their own notion of <a href="#elapsed"><code>elapsed</code></a> time.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mouse-button">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mouse-button</span>
      (<a href="#optkey">&amp;optkey</a> <var class="arg">upval</var> <var class="optval">= #f</var>, <var class="arg">downval</var> <var class="optval">= #t</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; object</td></tr>
</table>
<blockquote>
<p>
Returns <var>downval</var> if the mouse button is currently depressed, otherwise returns <var>upval</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mouse-x">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mouse-x</span>
      (<a href="#optkey">&amp;optkey</a> <var class="arg">minval</var> <var class="optval">= 0.0</var>, <var class="arg">maxval</var> <var class="optval">= 1.0</var>, <var class="arg">warp</var> <var class="optval">= 1.0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the screen mouse x position scaled <var>minval</var> to <var>maxval</var>, where <var>minval</var> is the value returned when the mouse is full-left on the screen and <var>maxval</var> is the value at full-right. If <var>warp</var> is 1 the interpolation is linear, otherwise values greater than 1 produce increasing exponential spread towards the right and values less than 1 produce decreasing spread.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mouse-y">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mouse-y</span>
      (<a href="#optkey">&amp;optkey</a> <var class="arg">minval</var> <var class="optval">= 0.0</var>, <var class="arg">maxval</var> <var class="optval">= 1.0</var>, <var class="arg">warp</var> <var class="optval">= 1.0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; float</td></tr>
</table>
<blockquote>
<p>
Returns the screen mouse y position scaled <var>minval</var> to <var>maxval</var>, where <var>minval</var> is the value returned when the mouse at the top of the screen and <var>maxval</var> is the value at the bottom. If <var>warp</var> is 1 the interpolation is linear, otherwise values greater than 1 produce increasing exponential spread towards the bottom and values less than 1 produce decreasing spread.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="shell">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">shell</span> (<var class="arg">command</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Calls operating system's shell interpreter to execute user's <var>command</var>.
</p>
</blockquote>


<!-- DEFINITION -->
<table class="entry" id="load">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">load</span> (<var class="arg">file</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>

<p>
Loads a Lisp or <a href="#sal">SAL</a> <var>file</var>. If <var>file</var> has no directory component and the <a href="#chdir">current working directory</a> does not contain <var>file</var> then the embedded distribution will be searched for the <var>file</var> to load.
</p>

</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="chdir">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">chdir</span> (<var class="arg">directory</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Changes the current working directory to <var>directory</var> (string).
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pwd">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pwd</span> ()
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; string</td></tr>
</table>
<blockquote>
<p>
Returns the full pathname string of the current working directory.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="directory">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">directory</span> (<var class="arg">spec</var> <a href="#opt">&amp;opt</a>  <var class="arg">recurse</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of absolute filenames matching wildcard <var>spec</var>. If <var>recurse</var> is true then subdirectories are recursively searched.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="file-version">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">file-version</span> (<var class="arg">filename</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">version</var> <var class="optval">= #t</var>,
      <var class="arg">nooverwrite</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; string</td></tr>
</table>
<blockquote>
<p>
Returns a variant of <var>filename</var> with a version number appended to its name. If <var>vers</var> is <code>#t</code> then successive version numbers are appended (starting with 1), if <var>vers</var> is a number then that number is used as the version number, else if <var>vers</var> is false then no version number is appended to the name. If <var>nooverwrite</var> is true the versioned file name is guaranteed to be for a new file, i.e. if that name is used for output no existing file will be overwritten.
</p>
</blockquote>
<!-- END DEFINITION -->

<h2 id="iteration">Iteration</h2>

<p>An (essentially) complete implementation of the Common Lisp loop macro is provided in Scheme and <a href="#sal">SAL</a>.</p>

<!-- DEFINITION -->
<table class="entry" id="loop">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">loop</span> <span class="meta">[</span><a href="#with"><var class="arg">with-decl</var></a><span class="meta">]</span> <span class="meta">{</span><var class="arg">stepping</var><span class="meta">}*</span> <span class="meta">{</span><var class="arg">stopping</var><span class="meta">}*</span> <span class="meta">{</span><var class="arg">action</var><span class="meta">}+</span> <span class="meta">[</span><var class="arg">finally</var><span class="meta">]</span>
 <span class="commandname">end</span></td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr class="entry">
    <td class="formals">
      (<span class="funcname">loop</span> <span class="meta">{</span><var>clause</var><span class="meta">}*</span>)
    </td>
    <!-- td class="label">Scheme Macro</td -->
  </tr>
  <tr><td class="retval">&rarr; loop dependent value</td></tr>

<!-- END DEFINITION -->

</table>
<blockquote>
<p>
Defines an iteration. Optional local variables can be declared using the <a href="#with"><code>with</code></a> statement followed by zero or more <var>stepping</var> statements, zero or more <var>stopping</var> statements, one or more <var>action</var> statements, an optional <var>finally</var> statement and terminated with the required <code>end</code> tag.
</p> 

<blockquote>
<table class= "float">

<tr>
  <th colspan="2" class="lcol" style="padding-right: 1em">stepping statements</th>
</tr>

<tr>
  <td><code><span class="reserved">repeat</span></code> <var>expr</var></td> <td> sets the iteration limit to <var>expr</var> </td>
</tr>

<tr>
  <td><code><span class="reserved">for</span></code> <var>var</var> <code><span class="reserved">=</span></code> <var>expr</var> <span class="meta">[</span><code><span class="reserved">then</span></code> <var>expr2</var><span class="meta">]</span></td> <td> sets <var>var</var> to the value of <var>expr</var> on each iteration. If <code><span class="reserved">then</span></code> is specified <var>expr</var> is the initial value and <var>expr2</var> are the subsequent values</td>
</tr>

<tr>
  <td><code><span class="reserved">for</span></code> <var>var</var> <code><span class="reserved">in</span></code> <var>expr</var></td> <td> increments <var>var</var> over elements the list <var>expr</var></td>
</tr>

<tr>
  <td><code><span class="reserved">for</span></code> <var>var</var> <span class="meta">[</span><code><span class="reserved">from</span></code> <var>expr</var><span class="meta">]</span> <span class="meta">[</span><code><span class="reserved">to</span> | <span class="reserved">below</span></code> <var>expr</var><span class="meta">]</span> <span class="meta">[</span><code><span class="reserved">by</span></code> <var>expr</var><span class="meta">]</span></td> <td> increments <var>var</var> from an on optional starting value to an ending value by an optional amount</td>
</tr>

<tr>
  <th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em">stopping statements</th>
</tr>

<tr>
  <td><code><span class="reserved">while</span></code> <var>expr</var></td> <td> iteration continues while <var>expr</var> is true</td>
</tr>

<tr>
  <td><code><span class="reserved">until</span></code> <var>expr</var></td> <td> iteration stops when <var>expr</var> is true</td>
</tr>

<tr>
  <th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em">conditional statements</th>
</tr>

<tr>
  <td><code><span class="reserved">when</span></code> <var>expr</var></td> <td> action executed if <var>expr</var> is true</td>
</tr>

<tr>
  <td><code><span class="reserved">until</span></code> <var>expr</var></td> <td> action executed if <var>expr</var> is false</td>
</tr>

<tr>
  <th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em;">action statements</th>
</tr>

<tr>
  <td> <span class="reserved">do</span>  <var>expr...</var></td> <td>  scheme expressions </td>
</tr>

<tr>
  <td> any SAL statement</td> <td>  SAL statements execute but do not return values</td>
</tr>

<tr>
  <th colspan="2" class="lcol" style="border-top: 1px solid gray; padding-right: 1em;">finally statements</th>
</tr>

<tr>
  <td><code><span class="reserved">finally</span></code> <var>statement</var></td> <td>executes <var>statement</var> as soon as iteration has completed</td>
</tr>

</table>
</blockquote>
</blockquote>

<h2 id="audio">Audio</h2>

<p>
Depending on the which particular Audio Target you are working with, audio data can be generated in four different ways:
</p>

<ol>
  <li>sending data to an open audio port in real time.</li>
  <li>sending data to an <a href="#file">open audio file</a> (non-real time).</li>
  <li><a href="#scheduler">sprouting processes</a> to send audio to an open audio port in real time.</li>
  <li><a href="#scheduler">sprouting processes</a> to send audio to an open audio file (non-real time).</li>
</ol>

<p>
Here are small examples of each method:
</p>

<div class="float">
  
<pre class="code">
<span class="comment">; example 1: sending data to the open Midi Port in real time</span>

<span class="reserved">loop</span> <span class="reserved">for</span> i <span class="reserved">below</span> 10
  mp:midi(i * .1, <span class="keyword">key:</span> between(60,90))
<span class="reserved">end</span>

<span class="comment">; example 2: sending data to a Midi File (non-real time)</span>

<span class="reserved">file</span> <span class="string">"test.mid"</span> ()
  <span class="reserved">loop</span> <span class="reserved">for</span> i <span class="reserved">below</span> 10
    mp:midi(i * .1, <span class="keyword">key:</span> between(60,90))
  <span class="reserved">end</span>
<span class="reserved">end</span>

<span class="comment">; example 3: sprouting process to send data to the open Midi Port in real time</span>

<span class="reserved">process</span> simp(num, low, high)
  <span class="reserved">repeat</span> num
  mp:midi(<span class="keyword">key:</span> between(60,90))
  <span class="reserved">wait</span> .1
<span class="reserved">end</span>

sprout(simp(10, 60, 90)

<span class="comment">; example 4: sprouting process to send data to a Midi File (non-real time)</span>

sprout(simp(10,60, 90), <span class="string">"test.mid"</span>)
</pre>
</div>

<p>Which method you use depends on what you want to accomplish and which methods the Audio Port in question supports. Here is a table that shows the capabilities of each Audio Target:</p>

<table > <!-- width="80%" -->
<tr >
<th class="lcol">audio target</th> <th class="lcol">real time port?</th> <th class="lcol">score file? (non-real time)</th> </tr>
<tr ><td>Midi</td>                <td>yes</td>                <td>yes</td>  </tr>
<tr ><td>Fomus</td>                <td>no</td>                <td>yes</td> </tr>
<tr ><td>CLM</td>                <td>no</td>                <td>yes</td>    </tr>
<tr ><td>Csound</td>                <td>no</td>                <td>yes</td> </tr>
<tr ><td>OSC</td>                <td>yes</td>                <td>no</td>    </tr>
</table>

<h3 id="midi-out">Midi Out</h3>

<p>Before sending anything to the Midi Out port select use the <span
class="menuitem">Audio&gt;Midi Out&gt;</span> menu to select an output device. You can test that the connection actually works by using the
<span class="menuitem">Ports&gt;Midi Out&gt;Test</span> to send a
random burst of messages to the output device.</p>

<!-- DEFINITION -->
<table class="entry" id="mp:midi">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:midi</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">dur</var> <var class="optval">= .5</var>, <var class="arg">key</var> <var class="optval">= 60</var>, <var class="arg">amp</var> <var class="optval">= .5</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
    
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Send note data to midi port. Note: if a process using mp:midi is sprouted in the context of a Fomus score then mp:midi will automatically route its note date to the Fomus score, with the midi channel number used as the Fomus part id.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:on">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:on</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">key</var> <var class="optval">= 60</var>, <var class="arg">amp</var> <var class="optval">= .5</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Send note on data to midi port. Supports floating point keynums and tunings
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:off">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:off</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">key</var> <var class="optval">= 60</var>, <var class="arg">vel</var> <var class="optval">= 127</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote><p>Sends note off data to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:prog">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:prog</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">val</var> <var class="optval">= 0</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote><p>Sends program change value to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:ctrl">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:ctrl</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">num</var> <var class="optval">= 0</var>, <var class="arg">val</var> <var class="optval">= 0</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote><p>Sends control change data to midi port.</p></blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:touch">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:touch</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">val</var> <var class="optval">= 0</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends after touch value to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:press">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:press</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">val</var> <var class="optval">= 0</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends channel pressure value to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:bend">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:bend</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>, <var class="arg">val</var> <var class="optval">= 8192</var>, <var class="arg">chan</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends pitch bend value 0-16383 to midi port.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:instruments">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:instruments</span> (<var class="arg">prog</var> <var class="rest">...</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends up to sixteen program changes out the Midi port and updates the port's instrument table. The position of each value specifies the channel it is sent to, i.e. the first program change is sent to channel 0 and so on. To skip a particular channel provide #f as its program change value, otherwise the value should be either a program change (integer 0-127) or a GM instrument name (string), in which case the first instrument that matches or contains name as a substring will be selected.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:tuning">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:tuning</span> (<var class="arg">divisions</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Divides midi frequency space into <var>divisions</var> steps per semitone and automatically quantizes floating point key numbers in midi data to the nearest tuning step as they are sent out the port. A <var>division</var> of 1 implements standard semitonal tuning, 2 implements quarter-tone tuning, and so on. The maximum <var>divisions</var> of 16 per semitone provides a tuning step size of 6.25 cents, very close to the minimum perceivable frequency change (see table below.) For example, in quartertone tuning there are a total of 8 midi channels available (channel numbers 0 to 7, each with their own instrument assignment) and fractional keynum values <var>k</var>.0 &lt; <var>k</var>.5 (e.g. 60.0 &lt; 60.5) are quantized to the semitone and <var>k</var>.5 &lt; <var>K</var>.0 (e.g. 60.5 &lt; 61.0) are tuned to the quartertone. In some configurations it is possible to send both standard tuning in parallel with microtonal tuning by using any remaining "standard" channels numbers for semitonal output.
Channel tuning is very efficient because it claims certain channels and "pretunes" them for the appropirate divisions.</p>

<table >
<tr><th >divisions</th>  <th class="headingth">tuning step</th>  <th class="headingth">microtuned<br/> channel #</th> <th class="headingth">standard<br/> channel #</th>
</tr>

<tr><td>1</td> <td>semi tone</td>   <td> &mdash;</td> <td>0-15</td></tr>
<tr><td>2</td> <td>quarter tone (50 cents)</td>   <td>0-7</td>  <td> &mdash;</td></tr>
<tr><td>3</td> <td>third tone (33 cents)</td>   <td>0-4</td> <td>15</td></tr>
<tr><td>4</td> <td>fourth tone (25 cents)</td>   <td>0-3</td> <td> &mdash;</td> </tr>
<tr><td>5</td> <td>fifth tone (20 cents)</td>   <td>0-2</td> <td> 15</td> </tr>

<tr><td>6</td> <td>sixth tone (16.6 cents)</td>   <td>0-1</td> <td> 12-15</td> </tr>
<tr><td>7</td> <td>seventh tone (14.28 cents)</td>   <td>0-1</td> <td> 14-15</td> </tr>
<tr><td>8</td> <td>eighth tone (12.5 cents)</td>   <td>0-1</td> <td> &mdash;</td> </tr>
<tr><td>9</td> <td>ninth tone (11.1 cents)</td>   <td>0</td> <td> 9-15</td> </tr>
<tr><td>10</td> <td>tenth tone (10 cents)</td>   <td>0</td> <td> 10-15</td> </tr>
<tr><td>11</td> <td>eleventh tone (9.09 cents)</td>   <td>0</td> <td> 11-15</td> </tr>
<tr><td>12</td> <td>twelfth tone (8.33 cents)</td>   <td>0</td> <td> 12-15</td> </tr>
<tr><td>13</td> <td>thirteeth tone (7.69 cents)</td>   <td>0</td> <td> 13-15</td> </tr>
<tr><td>14</td> <td>fourteenth tone (7.14 cents)</td>   <td>0</td> <td> 14-15</td> </tr>
<tr><td>15</td> <td>fifteenth tone (6.66 cents)</td>   <td>0</td> <td> 15</td> </tr>
<tr><td>16</td> <td>sixteenth tone (6.25 cents)</td>   <td>0</td> <td> &mdash;</td> </tr>



</table>


</blockquote>
<!-- END DEFINITION -->



<h3 id="midi-in">Midi In</h3>

<!-- DEFINITION -->
<table class="entry" id="mp:receive">
  <tr class="entry"> <td class="formals">
    <span class="funcname">mp:receive</span> (<var class="arg">function</var>)
  </td>
  </tr>
  <tr class="entry"> <td class="formals">
    <span class="funcname">mp:receive</span> (<var class="arg">opcode</var>, <var class="arg">function</var>)
  </td>

  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Causes <var>function</var> to receive incoming MIDI messages. To clear an existing receiver specify <code>#f</code> as the  <var>function</var>. Otherwise <var>function</var> should be a procedure of one argument; this procedure will be called with a list of message values <code>(</code><var>opcode channel data1 data2</var><code>)</code> for each message that arrives at the MIDI input port.
</p>

<p id="midi_opcodes">
To associate the receiver with a specific type of message precede <var>function</var> by the MIDI <var>opcode</var> 8-15 that it should handle. MIDI opcodes 8-15 are also available as constants: <code>mm:off</code>, <code>mm:on</code>, <code>mm:touch</code>, <code>mm:ctrl</code>, <code>mm:prog</code>, <code>mm:press</code>, <code>mm:bend</code>. 
If no opcode is given then <var>function</var> becomes the "default" receiver and is called on any message that is not otherwise handled by an opcode receiver.  Note that it possible to have several receivers, including a default receiver, in effect at the same time, each handling a different type of message.
</p>

<p>
To clear all current receivers call <code>mp:receive</code> with no arguments. 
</p>

</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="mp:receive_qm">
  <tr class="entry"> <td class="formals">
      <span class="funcname">mp:receive?</span> (<a href="#opt">&amp;opt</a> <var class="arg">opcode</var> <var class="optval">= #f</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; boolean or list</td></tr>
</table>
<blockquote>
<p>
Returns true if a receiver for <var>opcode</var> is currently in effect otherwise false.  If called without any <var>opcode</var> then a list containing the opcodes of all current receivers is returned. The default receiver, if any, is indicated by an opcode of 0.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:inchans" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:inchans</span> (<var class="arg">chan ...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Enables MIDI input only on the specified channels. Channel values are integers between 0 and 15. Specify a single <code>#t</code> value to enable all channels and <code>#f</code> to disable all channels.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="mp:inops" class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">mp:inops</span> (<var class="arg">opcode ...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Enables MIDI input only for the specified MIDI opcodes. Opcodes are integers between #x8 and #xE (<code id="mm:off">mm:off</code> <code id="mm:on">mm:on </code> <code id="mm:touch">mm:touch</code> <code id="mm:ctrl">mm:ctrl</code> <code id="mm:prog">mm:prog</code> <code id="mm:press">mm:press</code> <code id="mm:bend">mm:bend</code>). Specify a single <code>#t</code> to enable all opcode types and <code>#f</code> to disable all opcodes.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="midifile-header" class="entry">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">midifile-header</span> (<var class="arg">file</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns a list of MIDI header information from the specified <var>file</var>. The format of this list is (<var>tracks</var> <var>format</var> <var>tempo</var> <var>timesig</var> <var>maxtime</var>) where <var>tracks</var> is the number of tracks in the  file, <var>format</var> is the time format of the file (if positive its the number of ticks per quarter else its SMPTE), <var>tempo</var> is the initial tempo or #f <!-- , <var>timesig</var> is an initial time signature (if any) --> , and <var>maxtime</var> the maximum time stamp found in any track.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table id="midifile-import" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">midifile-import</span> (<var class="arg">file</var>, <var class="arg">track</var>, <var class="arg">values</var>)
  </td>
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>

<blockquote>
<p>
Returns a list of MIDI <var>values</var> from the specified <var>track</var> (zero based) in <var>file</var>. Messages that match (contain) the specified values are processed, messages that do not match do not appear in the returned list. <var>Values</var> can be a single value, a single list of values or a list of lists of values. Each individual value can be a string, symbol, or keyword as defined below. To return more that one value from messages specify a single list of values. In this case lists of data are returned, where each data list is a match for the specfied values. If a list of lists of values is specified then any message that matches any of those value lists are collected as described above.
</p>


<blockquote>
<table>
  <tr>
    <th class="lcol" style="padding-right: 2em;">Value</th> <th class="lcol" style="padding-right: 2em;">Matching Messages</th> <th class="lcol">Description</th>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"op"</span></td> <td> all </td> <td>the opcode of the message.
      Channel message opcodes are: note = 9, aftertouch = 10, controller = 11,  program = 12, pressure = 13, pitchbend = 14.
      Meta message opcodes are: seqnum = 0, text = 1, copyright = 2, trackname = 3, instname = 4, lyrics = 5, marker = 6, cue = 7, chanprefix = 32, tempo = 81, timesignature = 88, keysignature = 89.
</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"time"</span></td> <td>all</td> <td>the start time of the message in seconds</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"delta"</span></td> <td>all</td> <td>the time increment from the previous message</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"chan"</span></td> <td> channel messages </td> <td>the channel of the message 0-15</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"rhythm"</span></td> <td> notes </td> <td>the time increment from the previous note</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"dur"</span></td> <td> notes </td> <td>the duration of the note</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"key"</span></td> <td> notes </td> <td>the key number of the note</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"amp"</span></td> <td> notes </td> <td>the amplitude of the note 0.0-1.0</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"vel"</span></td> <td> notes </td> <td>the key velocity the note 0-127</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"touch"</span></td> <td> after touches </td> <td>the after touch value 0-127</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"ctrl1"</span></td> <td> control changes </td> <td>the controller number 0-127</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"ctrl2"</span></td> <td> control changes </td> <td>the controller value 0-127</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"prog"</span></td> <td> program changes </td> <td>the program value 0-127</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"press"</span></td> <td> channel pressures </td> <td>the pressure value 0-16383</td>
  </tr>
  <tr style="vertical-align:top;">
    <td><span class="string">"bend"</span></td> <td> pitch bends </td> <td>the pitch bend value 0-16383</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"seqnum"</span></td> <td> seqnum meta events </td> <td>the sequence number</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"text"</span></td> <td> text meta events (opcodes 1-7) </td> <td>the text string of the message</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"chanpre"</span></td> <td> channel meta events </td> <td>the channel prefix number</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"tempo"</span></td> <td> tempo meta events </td> <td>the tempo as quarters per second</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"timesig"</span></td> <td> time signatures </td> <td>a time signature list (<var>numerator denominator</var>)</td>
  </tr>

  <tr style="vertical-align:top;">
    <td><span class="string">"keysig"</span></td> <td> key signatures </td> <td>a key signature -7 to 7</td>
  </tr>

</table>
</blockquote>
<h4>Example</h4>
<pre>
<span class="comment">;; find out what kind of messages are in track 0</span>
midifile-import("zincline-1.mid", 0, "op")

<span class="comment">;; import the start times, key numbers and durations of all notes in track 1</span>
midifile-import("zincline-1.mid", 1, {"time" "key" "dur"})

<span class="comment">;; import all tempo changes and program changes from track 0</span>
midifile-import("zincline-1.mid", 0, {{"op" "tempo"} {"op" "prog" "chan"}})
</pre>


</blockquote>
<!-- END DEFINITION -->


<h3 id="clm">CLM/SndLib</h3>

<p> Use <span class="menuitem">File&gt;Load...</span> or <span class="menuitem">Audio&gt;Instrument Browser...</span> to load
CLM instruments before working with them.</p>

<h4 id="sndlib_options">SndLib Audio File Options</h4>
<p>
Any CLM <a href="http://ccrma.stanford.edu/software/snd/snd/sndscm.html#withsound">with-sound</a> option can be passed as an argument to <a href="#sprout">sprout</a> when you generate an audio file. The most common options are listed here and are also available in the <span class="menuitem">Audio&gt;SndLib&gt;</span> menu.
</p>

<dl>
  <dt><code><span class="keyword">srate:</span></code></dt>
  <dd>The sampling rate to use.</dd>
  <dt><code><span class="keyword">channels:</span></code></dt>
  <dd>The number of audio channels to write.</dd>
  <dt><code><span class="keyword">play:</span></code></dt>
  <dd>Play the audio file after writing it.</dd>
</dl>  

<!--  BEGIN FOMUS -->

<h3 id="fomus">Fomus</h3>

<p>
<a href="http://fomus.sourceforge.net">Fomus</a> generates musical scores for LilyPond, Sibelius and Finale
from symbolic score information input by the user interactively or by running musical processes. Use the <span class="menuitem">Audio&gt;Fomus&gt;</span> menu to configure your
Fomus environment and manage its score output. For more information see the examples in <span class="menuitem">Help&gt;Examples&gt;Fomus Examples</span> and the tutorial in <span class="menuitem">Help&gt;Tutorials&gt;Fomus</span>.
</p>

<h4 id="fomus_events">Fomus Events</h4>

<!-- DEFINITION -->
<table id="fms:note" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:note</span> (<var class="arg">time</var>,
    <var class="arg">dur</var>,
    <var class="arg">pitch</var>
    <a href="#optkey">&amp;optkey</a>
    <var class="arg">part</var>  <var class="optval">= #f</var>,

    <var class="arg">voice</var> <var class="optval">= 1</var>,
    <var class="arg">dyn</var> <var class="optval">= 0</var>,
    <var class="arg">grace</var>,
    <var class="arg">marks</var> <var class="optval">= {}</var>,
    <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Send a note event to the currently selected score at <var>time</var>.
Parameters <var>dur</var> and <var>pitch</var> are required. The optional parameters <var>marks</var>
and <var>sets</var> are lists of <a href="#marks">marks</a> and <a href="#settings">settings</a>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:rest" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:rest</span> (<var class="arg">time</var>,
    <var class="arg">dur</var>
    <a href="#optkey">&amp;optkey</a> 
    <var class="arg">part</var> <var class="optval">= #f</var>,
    <var class="arg">voice</var> <var class="optval">= 1</var>,
    <var class="arg">grace</var>,
    <var class="arg">marks</var> <var class="optval">= {}</var>,
    <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Send a rest event to the currently selected score at <var>time</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:mark" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:mark</span> (<var class="arg">time</var>,
    <var class="arg">dur</var> 
<a href="#optkey">&amp;optkey</a>
    <var class="arg">part</var>  <var class="optval">= #f</var>,
    <var class="arg">voice</var> <var class="optval">= 1</var>,
    <var class="arg">grace</var> ,
    <var class="arg">marks</var> <var class="optval">= {}</var>,
    <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Send a mark event to the currently selected score at <var>time</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:meas" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:meas</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>,
    <var class="arg">dur</var> <var class="optval">= 0</var>,
    <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Send a measure to the currently selected to score at <var>time</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4 id="fomus_objects">Fomus Objects</h4>

<!-- DEFINITION -->
<table id="fms:part" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:part</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a new part to use in the currently selected score.  A part with
id <code>default</code> exists (with instrument <code>default</code>) if no other parts are
defined.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:inst" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:inst</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a new instrument to use in the currently selected score.  An
instrument with id <code>default</code> and a grand staff exists if no other
instruments are defined.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:percinst" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:percinst</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a new percussion instrument to use in the currently selected
score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:metapart" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:metapart</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a new metapart to use in the currently selected score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:setting" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:setting</span> (<var class="arg">set</var>,
    <var class="arg">value</var>
    <a href="#optkey">&amp;optkey</a> <var class="arg">append</var> <var class="optval">= #f</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote><p>
Change the value of one or more global settings in the currently
selected score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:measdef" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:measdef</span> (<a href="#optkey">&amp;optkey</a> <var class="arg">sets</var> <var class="optval">= {}</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a new measure definition to use in the currently selected
score.  Measdefs are more useful in .fms files than in processes.
</p>
</blockquote>
<!-- END DEFINITION -->

<h4 id="fomus_commands">Fomus Commands</h4>

<!-- DEFINITION -->
<table id="fms:new-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:new-score</span> (<var class="arg">file</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Create a brand new empty score with output <var>file</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:load-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:load-score</span> (<var class="arg">file</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Load a .fms file into a new score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:select-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:select-score</span> (<var class="arg">file</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Select the first score with output <var>file</var>.  A new empty
score is created if one with that name does not already exist.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:save-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:save-score</span> (<var class="arg">file</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Save the score to a .fms file, Fomus's native file format.  The file
can be edited and/or reloaded with the <a href="#fms:load-score">load-score</a> command.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:merge-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:merge-score</span> (<var class="arg">fromfile</var>
    <a href="#optkey">&amp;optkey</a> <var class="arg">time</var> <var class="optval">= 0</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Merge the contents of the score identified by <var>fromfile</var> into the current score.
Contents include note events, measures and possibly parts if they don't already exist.
The optional <var>time</var> argument shifts the events in time by the specified amount.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:run" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:run</span> ()
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Run Fomus on the currently selected score.  If an output file has
not been specified, this produces an error.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:clear-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:clear-score</span> ()
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Clears note events and measures (but not part or instrument
definitions) from the currently selected score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="fms:delete-score" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">fms:delete-score</span> ()
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Delete the currently selected Fomus score.
</p>
</blockquote>
<!-- END DEFINITION -->

<!--  END FOMUS -->



<h3 id="osc">OSC (Open Sound Control)</h3>


<p>
The OSC port provides input and output communication with other processes via the <a href="http://opensoundcontrol.org/">Open Sound Control</a> protocol. To send and receive OSC messages first open an OSC connection via the <span class="menuitem">Audio&gt;OSC Connections...</span> dialog or by calling the <code>"osc:open-input"</code> and <code>"osc:open-output"</code> functions.</p>

<p> See the <span class="menuitem">Help&gt;Examples&gt;OSC</span> menu for <a href="osc.sal">examples of using OSC</a>.</p>

<p>
<span style="font-weight: bold">IMPLEMENTATION NOTE (May 2017):</span> Grace now uses JUCE's native implementation of the Open Sound Control protocol. While Grace continues to support all valid <a href="#osc_type_table">OSC types</a> in code (see below), JUCE currently supports sending only int32, float32, and string messages, which means that all data you send will be mapped to one of three subtypes automatically. For example, sending #t (OSC_TRUE) will be mapped to 1, and #f (OSC_FALSE) will be mapped to 0.  Note that it is possible to use the OSC address to distinguish between types that are not explicitly supported by JUCE. For example, to distinguish boolean 1 from integer 1, you can tag the data as boolean in the address, eg. <code>(osc:send "/grace/bool" bool)</code>.
</p>

<!-- DEFINITION -->
<table id="osc:open-input" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:open-input</span> (<var class="arg">port</var>)
  </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Opens an OSC input connection to the specified <var>port</var>, which should be an integer between 1 and 15000.  Returns true if the connection was made, otherwise false.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="osc:close-input" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:close-input</span> ()
  </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Closes the open OSC input connection. Returns true if the connection was closed, otherwise false.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="osc:open-output" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:open-output</span> (<var class="arg">port</var>)
  </td>
  </tr>
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:open-output</span> (<var class="arg">host</var>, <var class="arg">port</var>)
  </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Opens an OSC output connection to the specified <var>port</var>. If you provide only a port then target host is your machine, e.g. "localhost" or "127.0.0.1".  To route to a specific host machine you should pass its IP address string as the first argument and the port as the second.  For example, <code>osc:open-output("127.0.0.1", 57120)</code> is exactly the same as <code>osc:open-output(57120)</code>. Returns true if the connection was made, otherwise false.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="osc:close-output" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:close-output</span> ()
  </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Closes the open OSC output connection. Returns true if the connection was closed, otherwise false.
</p>
</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table id="osc:message" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:message</span> (<var class="arg">path</var>, <var class="rest">data ...</var>)</td>
  </tr>
  <tr class="entry"> <td class="formals"><span class="funcname">osc:message</span> (<var class="arg">list</var>)</td>
  </tr>

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends an OSC message consisting of an OSC <var>path</var> (string) followed by zero or more optionally tagged <var>data</var> values. Message values can be specified as separate arguments or in a single <var>list</var> argument to the function. Scheme values integer, float, string, symbol, character, boolean true, boolean false all map directly to their OSC equivalents and do not need tagging.  To distinguish between different OSC types for a particular scheme value (e.g. 32 bit vs 64 bit integers), precede the Scheme value by the appropriate OSC data tag as shown in the table below.  Lists holding OSC blobs or OSC four-byte midi messages must be tagged as such using <code>:b</code> or <code>:m</code>, respectively. The special OSC tags <code>:T :F :N :I</code> are themselves data, i.e. they not take Scheme values.
</p>

<div class="float" id="osc_type_table">
  <table > <!-- width="50%" -->
    <tr><th class="lcol">OSC Tag</th> <th class="lcol">Osc Type</th>  </tr>
    <tr> <td> <code>:i</code> </td> <td>32 bit integer</td> </tr>
    <tr> <td> <code>:h</code> </td> <td>64 bit integer</td> </tr>
    <tr> <td> <code>:f</code> </td> <td>32 bit float</td> </tr>
    <tr> <td> <code>:d</code> </td> <td>64 bit float (double)</td> </tr>
    <tr> <td> <code>:c</code> </td> <td>character</td> </tr>
    <tr> <td> <code>:s</code> </td> <td>string</td> </tr>
    <tr> <td> <code>:S</code> </td> <td>symbol</td> </tr>
    <tr> <td> <code>:b</code> </td> <td>blob</td> </tr>
    <tr> <td> <code>:m</code> </td> <td>midi</td> </tr>
    <tr> <td> <code>:T</code> </td> <td>OSC true</td> </tr>
    <tr> <td> <code>:F</code> </td> <td>OSC false</td> </tr>
    <tr> <td> <code>:N</code> </td> <td>OSC nil</td> </tr>
    <tr> <td> <code>:I</code> </td> <td>OSC infinitude</td> </tr>
  </table>
</div>
</blockquote>


<!-- END DEFINITION -->


<!-- DEFINITION -->
<table id="osc:bundle" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:bundle</span> (<var class="arg">time</var>, <var class="rest">message ...</var>)
  </td>
  </tr>
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:bundle</span> (<var class="arg">time</var>, <var class="arg">list</var>)
  </td>
  </tr>

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Sends an OSC bundle consisting of a <var>time</var> tag (number) followed by one or more OSC <var>messages</var> . To send an "immediate" bundle, specify 0 as the time tag. Otherwise the relative time value will be converted to an OSC time value based on January 1 1900. Messages can be specified as separate arguments or in a single <var>list</var> argument to the function.
</p>
</blockquote>

<!-- DEFINITION -->
<table id="osc:receive" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:receive</span> (<var class="arg">function</var>)
  </td>
  </tr>
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:receive</span> (<var class="arg">path</var>, <var class="arg">function</var>)
  </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Causes <var>function</var> to receive incoming OSC messages. To clear an existing receive specify <code>#f</code> as the <var>function</var>. Otherwise <var>function</var> should be a procedure of one argument; this procedure will be called asynchronously and passed a list of message values <code>(</code><var>data1 data2 ...</var><code>)</code> for each message that arrives at the OSC input port.
To associate receiving with a specific osc message precede <var>function</var> by the OSC <var>path</var> (string) that it should handle. 
If no path is given then <var>function</var> becomes the "default" receiver and is called on any message that is not otherwise handled by a specific path receiver.  Message data for a default receiver will include the path of the message received: <code>(</code><var>path data1 data2 ...</var><code>)</code>.  Note that it possible to have several receivers, including a default receiver, in effect at the same time, each handling a different type of message.
</p>

<p>
To clear all current receivers call <code>osc:receive</code> with no arguments. 
</p>

</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table id="osc:receive_qm" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">osc:receive?</span> (<a href="#opt">&amp;opt</a>  <var class="arg">path</var>)
  </td>
  </tr>
  <tr><td class="retval">&rarr; boolean or list</td></tr>
</table>

<blockquote>
<p>
Returns true if a receiver for <var>path</var> is currently in effect otherwise false.  If called without any <var>path</var> then a list containing the paths of all current receivers is returned. The default receiver, if any, is indicated by a path of "/".
</p>
</blockquote>

<!--  END OSC -->

<!--  BEGIN CSOUND -->

<h3 id="csound">Csound</h3>

<p>Csound score files can be written and played in all versions of CM. Use the <span
class="menuitem">Audio&gt;Csound&gt;Settings...</span> dialog to
configure the Csound environment, or pass the options directly to the
scorefile when you generate it with <a href="#sprout">sprout</a>.
</p>

<!-- DEFINITION -->
<table id="cs:i" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">cs:i</span> (<var class="arg">ins</var>, <var class="arg">start</var>, <var class="arg">dur</var> <var class="rest">...</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>

<blockquote>
<p>
Sends instrument data to Csound.  The first value should be the instrument's number followed by the rest of its pfield values.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="cs:f" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">cs:f</span> (<var class="arg">num</var> <var class="rest">...</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Sends function table data to Csound. Similar to <span class="string">"cs:i"</span> in all other respects.

</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table id="cs:event" class="entry">
  <tr class="entry"> <td class="formals">
    <span class="funcname">cs:event</span> (<var class="arg">list</var>)
  </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Sends an <var>event list</var> to Csound. The first element in the list must be the event's type, either <code>i</code> or <code>f</code>. Similar to <span class="string">"cs:i"</span> and <span class="string">"cs:f"</span> in all other respects.

</p>
</blockquote>
<!-- END DEFINITION -->


<h4 id="csound_options">Csound Scorefile Options</h4>

<p> The following scorefile options are available in the <span
class="menuitem">Audio&gt;Csound&gt;</span> menu and can be passed to
Csound scores when you generate them using <a
 href="#sprout">sprout</a> or <a href="#file">file</a>.</p>

<dl>

  <dt><code><span class="keyword">play:</span></code></dt>

  <dd>Send the scorefile to Csound after it is written.</dd>

  <dt><code><span class="keyword">orchestra:</span></code></dt>

  <dd>Use this file as the Csound .orc file when the scorefile is played.</dd>

  <dt><code><span class="keyword">header:</span></code></dt>

  <dd>Include this string as the header of the scorefile.</dd>

  <dt><code><span class="keyword">write:</span></code></dt>

  <dd>Specify #f to put data in an internal score without writing it
  as a file. This lets you build a score incrementally, over
  consecutive sprouts, and to export score data to an editor window
  or the clipboard.</dd>

</dl>  


<h2 id="scheduler">The Scheduler</h2>

<p>The scheduler is a JUCE thread that executes (runs) <a href="#processes">musical processes</a> in real-time or in faster-than-real-time if files are being generated. The scheduler uses <a href="#metronomes">metronomes</a> to manage the rate of execution and is controlled using functions that <a href="#sprout">sprout</a>, <a href="#stop">stop</a>, <a href="#pause">pause</a> and <a href="#continue">continue</a> process execution.</p>

<h3 id="processes">Processes</h3>

<p>
Processes are iterative functions that you <a href="#sprout"> <code>sprout</code></a> into the scheduler to execute. <!-- Processes typically execute in real time but can also run faster-than real time if they are sprouted to generate an output file. --> In SAL you create a process using the <a href="process">process</a> statement. In Scheme you create a process using the <a href="#run">process</a> macro. The following two examples are equivalent process definitions:
</p>

<div class="float">
  <p>SAL process definition</p>
<pre class="code">
<span class="reserved">process</span> simp (reps, rate, low, hi)
  <span class="reserved">repeat</span> reps
      mp:midi(<span class="keyword">key:</span> between(low, hi))
      <span class="reserved">wait</span> rate
  <span class="reserved">end</span>

sprout(simp(20, .5, 60, 80))
</pre>

<p>Scheme process definition</p>
<pre class="code">
(<span class="reserved">define</span> (simp reps rate low hi)
  (<span class="reserved">process</span> <span class="reserved">repeat</span> reps
           <span class="reserved">do</span>
           (mp:midi <span class="keyword">:key</span> (between low hi))
           (wait rate)))

(sprout (simp 20 .5 60 80))
</pre>
</div>

<!-- DEFINITION -->
<table class="entry" id="defprocess">
    <tr class="entry">
    <td class="formals">
      <span class="commandname">process</span> <var class="arg">name</var> (<span class="meta">{</span><var class="arg">parameters</var><span class="meta">}*</span>) <span class="meta">{</span><var class="arg">iteration</var><span class="meta">}+</span> <span class="commandname">end</span> </td></tr> 
  <tr><td class="retval">&rarr; function</td></tr>

</table>
<blockquote>
<p>
Returns an iterative function to execute in the scheduler in real time or faster-than real time. <var>Parameters</var> consists of zero or more required parameters, optionally followed by <code><span class="reserved">&amp;optkey</span></code> and any <a href="#optkey_arguments">optkey arguments</a>.
Following the parameter list comes a series of iteration clauses as documented under <a href="#loop">loop</a> and with the following two additional features:
</p>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="wait">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">wait</span> <var class="arg">time</var>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>  

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Causes the process to wait <var>time</var> seconds before the next iteration. To stop the process provide negative <var>time</var> value. This function only exists within the lexical scope of a process definition.
</p>
</blockquote>
<!-- END DEFINITION -->

<p style="padding-top: 1em;">Expressions defined within the body of a process have access to <a href="#elapsed"><code>elapsed</code></a>, a (load) function that returns the time of the current process iteration:</p>
<!-- DEFINITION -->
<table class="entry" id="elapsed">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">elapsed</span> (<a href="#opt">&amp;opt</a> <var class="arg">scoretime?</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; seconds</td></tr>
</table>
<blockquote>
<p>
Returns the amount of time since the process was first sprouted, or the absolute score time (the time since the initial sprout) if the optional <var>scoretime</var> argument is <code>#t</code> This function only exists within the lexical scope of a process definition.
</p>
</blockquote>
<!-- END DEFINITION -->

</blockquote>

<h3 id="sprouting">Sprouting Processes</h3>

<p>The main entry point into the scheduler is called <a
 href="#sprout">sprout</a>.  Sprout schedules <a href="#processes">processes</a> to run in real
time, or in faster-than real time if a file (string) is specified as the third argument to the function.
</p>

<p>When the scheduler runs in real time processes can be manipulated
interactively using <a href="#metronomes"> metronomes</a> to control
 execution rates (tempi) and process <var>ids</var> (see below) to stop or
replace individual process currently running in the scheduler.</p>

<p> When the scheduler runs faster-than real time for file generation
then time values inside processes are treated as if they were seconds
but the scheduling clock is running as fast as it can, i.e. the
scheduling thread advances process times but does not actually wait
any amount of time before considering the next process in the queue.</p>

<h4 id="sprouting-real-time">Sprouting Processes in Real Time</h4>


<!-- DEFINITION -->
<table class="entry" id="sprout">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sprout</span> (<var class="arg">process</var> <a href="#opt">&amp;optkey</a> <var class="arg">ahead</var> <var class="optval">= 0</var>, <var class="arg">id</var> <var class="optval">= 0</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td> </tr>
</table>

<blockquote>

<p>

Starts one or more processes running in real-time. Each <a href="#processes"><var>process</var></a> begins executing either <var>ahead</var> seconds from now or ahead beats from now if <a href="#sync">sync</a> is used in conjuction with a <a href="metronome">metronome</a>.

Both <var>process</var> and <var>ahead</var> can be lists, in which case processes and start time are paired in a left-to-right order.</p>

<p>Each process is identified by an <var>id</var> in the scheduler. If no id is provided then the newly sprouted process is tagged with the special id 0. If an <var>id</var> is provided it should be a number or string that uniquely identifies the process in the scheduling queue. Uniquely tagged processes can then be selectively removed using <a href="#stop">stop</a> or <em>replaced</em> by sprouting a new process using the same id. In this case the running process is stopped and substituted by the new process. The new process will start in time, completing the wait time already underway. This allows you to "redefine" running processes on the fly, as in live coding.</p> 
</blockquote>

<h4 id="sprouting-to-files">Sprouting Processes to Generate Files</h4>


<!-- DEFINITION -->
<table class="entry">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sprout</span> (<var class="arg">process</var>, <var class="arg">file</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr class="entry">
    <td class="formals">
      <span class="funcname">sprout</span> (<var class="arg">process</var>, <var class="arg">ahead</var>, <var class="arg">file</var> <var class="rest">...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval">&rarr; void</td> </tr>
</table>

<blockquote>

<p>If a <var>file</var> is specified then the scheduler will run in faster-than real time and all output will be sent to the open file.
CM currently supports the following file types:
</p>

<ul id="score_file_types">
  <li><code><span class="string">".mid"</span></code> midi file.</li>
  <li><code><span class="string">".wav .aiff .snd"</span></code> audio file using SndLib.</li>
  <li><code><span class="string">".ly .xml .fms"</span></code> notated score using Fomus.</li>
  <li><code><span class="string">".sco"</span></code> Csound score file.</li>
</ul>

<p>Following <var>file</var> comes zero or more keyword options pairs suitable for the audio target selected by <var>file</var>:</p>

<ul>
  <li><a href="#midi_options">Midi file options</a></li>
  <li><a href="#sndlib_options">SndLib audio file options</a></li>
  <li><a href="#fomus_options">Fomus score options</a></li>
  <li><a href="#csound_options">Csound score options</a></li>
</ul>

</blockquote>
<!-- END DEFINITION -->



<h4>Other Scheduling Functions</h4>

<!-- DEFINITION 
<table class="entry" id="sprout-hook">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sprout-hook</span> (<a href="#opt">&amp;opt</a>  <var class="arg">hook</var> <var class="optkey">= #f</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; #f or procedure</td></tr>
</table>
<blockquote>
<p>
Gets or sets the current hook function associated with sprouting.
If called without any argument the current hook is return or #f if no hook is set. Otherwise, if <var>hook</var> is a function, it will be called each time sprout is invoked and passed the current output file or #f if no file was specified to sprout. To clear the current sprout hook specify #f as the <var>hook</var>.
</p>
</blockquote>

END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="stop">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">stop</span>
      (<var class="rest">id...</var>)
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval"> &rarr; void</td></tr>
</table>

<blockquote>
<p>
Stops processes currently running in the scheduling queue. If no ids
are given all the processes are stopped and any pending events in the
midi output queue are also flushed. Otherwise only processes with the
specified ids are stopped. Note that multiple processes can only share the
default id (0), in which case all processes sprouted with the default id can
be stopped if <var>id</var> = 0. Otherwise, processes have unique id numbers,
and can be stopped by indicating their id.
</p>
<p>
Note that <var>id</var> can be a number or a string. If a string is given, it is
converted into a unique id number. If a process was sprouted with a string id,
pass the same string into <var>stop</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="pause">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">pause</span>
      ()
    </td>
    <!-- td class="label">SAL</td -->
  </tr>

  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Suspends the process scheduler.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="cont">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">cont</span> ()
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Resumes the scheduler if it is currently paused.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="metronomes">Metronomes</h3>

<p>Metronomes allow you to change the tempo of running processes in
real-time. At least one metronome is always active, if you do not
specify a metronome the 'default' metronome will be in effect.  Each
metronome has a unique identifier that you use to access the metronome
from code; the id of the default metronome is 0.</p>

<!-- DEFINITION -->
<table class="entry" id="make-metro">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">make-metro</span> (<var class="arg">tempo</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; id</td></tr>
</table>
<blockquote>
<p>
Creates a new metronome with an initial <var>tempo</var> in beats per minute. Returns the unique id of the new metronome.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro_qm">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro?</span> (<var class="arg">metro</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Returns true if <var>metro</var> is the valid id of a metronome.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="delete-metro">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">delete-metro</span> (<var class="arg">metro</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Deletes the metronome with the id <var>metro</var>. The default metronome cannot be deleted.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metros">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metros</span> (<a href="#optkey">&amp;optkey</a>
      <var class="arg">user</var> <var class="optval"> = #f</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Returns a list of all existing metronome ids. If <var>user</var> is false (the default) then the list returned will include the default metronome at the front of the list. If <var>user</var> is #t, then the list will omit the default metronome and include only metronome that were created by the user.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro</span> (<var class="arg">tempo</var>,
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">secs</var> <var class="optval"> = 0</var>,
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Changes the tempo of metronome <var>metro</var> over time <var>secs</var>. If <var>secs</var> = 0, then the tempo change will be effective immediately.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro-beat">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro-beat</span> (<a href="#optkey">&amp;optkey</a>
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the exact beat of metronome <var>metro</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro-tempo">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro-tempo</span> (<a href="#optkey">&amp;optkey</a>
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the current exact tempo of metronome <var>metro</var>.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro-dur">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro-dur</span> (<var class="arg">beats</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; number</td></tr>
</table>
<blockquote>
<p>
Returns the equivalent time value for <var>beats</var> number of beats according to metronome <var>metro</var>. One can use this function to adjust duration and time offset values sent inside of midi messages, as <a href="#mp:midi">mp:midi</a> expects its duration in absolute seconds.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="sync">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">sync</span> (<a href="#optkey">&amp;optkey</a>
      <var class="arg">ahead</var> <var class="optval"> = 1</var>,
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; thunk</td></tr>
</table>
<blockquote>
<p>

Returns a special ahead value (a thunk) that  <a href="#sprout">sprout</a>  will use to quantize the start of the process to the  <var>ahead</var> beat (or beat subdivision) of  <var>metro</var>. For example, if <var>ahead</var> is 1, then the process will start on the beginning of the next beat. A value of .5 will start the process at the nearest offbeat. 1.5 will wait until the next beat, then start it on the offbeat of that beat. 2.75 will wait 2 beats, then start on the 3rd sixteenth note of that beat, and so on. Note that the ahead beat can never be zero because that beat is already underway.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro-sync">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro-sync</span> (<var class="arg">metro</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">beats</var> <var class="optval"> = 1</var>, 
      <var class="arg">tempo</var> <var class="optval"> = 0</var>, 
      <var class="arg">master-metro</var> <var class="optval"> = 0</var>,
      <var class="arg">mode</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Will adjust metronome <var>metro</var> such that it will align a downbeat to coincide with metronome <var>master-metro</var>. This alignment will be completed <var>beats</var> later according to the <var>master-metro</var>. If <var>tempo</var> is 0, the tempo of the <var>metro</var> will be set back to its former state once the sync is complete. If <var>tempo</var> is a positive number, the tempo of <var>metro</var> will be changed throughout the length of the syncing. Thus, once the specified number of <var>beats</var> has passed, <var>metro</var> will be at its new tempo and in sync with <var>master-metro</var>. In order to accomplish the syncing, <var>metro</var> must either speed up or slow down for a brief period of time.  <var>mode</var> = -1 will force <var>metro</var> to slow down, while <var>mode</var> = 1 will force it to speed up.  <var>mode</var> 0 will choose whichever method is most efficient. Will return true if a tempo adjustment was made. Will return false if the function decided to do nothing. This will happen if either the metronomes are already in sync, or if <var>metro-sync()</var> is called before a previous call to the function is complete.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="metro-phase">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">metro-phase</span> (<var class="arg">fitbeats</var>,
      <var class="arg">beatspace</var>
      <a href="#optkey">&amp;optkey</a>
      <var class="arg">metro</var> <var class="optval"> = 0</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; bool</td></tr>
</table>
<blockquote>
<p>
Will adjust the tempo of metronome <var>metro</var> such that over what would normally be the time of <var>beatspace</var>, <var>fitbeats</var> number of beats will happen instead. For example, if <var>fitbeats</var> = 11, and <var>beatspace</var> = 10, the tempo will be altered such that 11 beats will fit within the space of 10 beats.  After this is completed, the metronome returns to its previous tempo. Will return true if a phase adjustment was made. Will return false if the function decided to do nothing. This will happen if <var>metro-phase()</var> is called before a previous call to the function is complete.
</p>
</blockquote>
<!-- END DEFINITION -->


<h2 id="plotting">Plotting</h2>

<p>Plot windows allow you to display, edit and play back multiple layers of n-tuple point data. See <a href="plot.scm"><span class="menuitem">Help&gt;Examples&gt;Plotting</span></a> for various examples of creating plots by code.</p>

<p>Plot Window Point Commands:</p>
<ul>
  <li>Add new point: Control-Mouseclick</li>
  <li>Call a <a href="#plot-hook">plot hook</a>: Control-Option-Mouseclick</li>
  <li>Select points: drag region or click on point</li>
  <li>Add or remove points from selection: Shift-Click on point</li>
  <li>Delete selection: Delete key</li>
</ul>

<p>
The functions defined below provided an API for working with plots in Scheme or SAL buffers.
</p>

<!-- DEFINITION< -->
<table class="entry" id="plot">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plot</span>
      (<var class="rest"><span class="meta">{</span><var class="arg">setting</var><span class="meta">}*</span></var> <span class="meta">{</span><var class="arg">pointlist</var> <span class="meta">{</span><var class="arg">setting</var><span class="meta">}*}*</span>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Creates a new plot given zero or more global plot settings followed by
 zero or more <i>layers</i> of point lists with layer-specific settings. Point lists can be specified in one of the two following formats:

</p>

<dl>

<dt><code>(</code><var>x1</var> <var>y1</var> <var>x2</var> <var>y2</var> <var>...</var> <var>xn</var> <var>yn</var><code>)</code></dt>
<dd>A flat list of <var>x</var> <var>y</var> point data.</dd>

<dt id="point_record"><code>(</code> <code>(</code><var>v1</var> <var>v2</var> <var>...</var> <var>vn</var><code>)</code> <var>...</var><code>)</code></dt>
<dd>Each sublist defines a <var>point record</var> containing a value for every <a href="#fields">field</a> of plotted data.</dd>

</dl>

<p>
A <var>setting</var> is a plotting keyword followed by a value. In
general, setting values can be specified as symbols, keywords or
strings. Settings that appear before the first point list are treated
as <em>global settings</em>, i.e. they apply to  all
the point lists.  Settings specified after a point list apply only to
that layer of points.</p>

<p><code class="entry">plot</code> supports following settings:</p>

<dl>

  <dt id="title"><span class="keyword"><code>title:</code></span> <var>string</var></dt>
  <dd>As a global setting is specifies the window title or the title of the point layer if it appears after a point list.</dd>
  
  <dt id="xaxis"><span class="keyword"><code>xaxis:</code></span> <var>type</var> | (<var>type from to by ticks</var>)</dt>
  <dd> Specifies the horizontal axis type and (optionally) its characteristics. 
    
    <blockquote>
    <table class="float"> <!-- width="50%" -->
      <caption>Available axis types and their default characteristics</caption>
      <tr><th class="lcol">type</th> <th class="lcol">from</th> <th class="lcol">to</th><th class="lcol">by</th><th class="lcol">ticks</th></tr>
      <tr><td><code>unit</code>   </td><td> 0  </td><td> 1      </td><td> .25 </td><td> 5 </td></tr>
      <tr><td><code>percent</code></td><td> 0  </td><td> 100    </td><td> 25  </td><td> 5 </td></tr>
      <tr><td><code>keynum</code> </td><td >0  </td><td> 127    </td><td> 12  </td><td> 1 </td></tr>  
      <tr><td><code>midi</code>   </td><td >0  </td><td> 127    </td><td> 16  </td><td> 2 </td></tr>  
      <tr><td><code>seconds</code></td><td> 0  </td><td> 60     </td><td> 1   </td><td> 4 </td></tr>
      <tr><td><code>ordinal</code></td><td> 0  </td><td> length </td><td> 1   </td><td> 1 </td></tr>
      <tr><td><code>circle</code> </td><td> -1 </td><td> 1      </td><td> .25 </td><td> 4 </td></tr>
    </table>
    </blockquote>

    See the <a href="#fields">fields:</a> setting for complete control over record fields and axes.
    
  </dd>
  
  <dt id="yaxis"><span class="keyword"><code>yaxis:</code></span> <var>type</var> | (<var>type from to by ticks</var>)</dt>
  <dd> Specifies the vertical axis type and (optionally) its characteristics.
    See the <a href="#fields">fields:</a> setting for complete control over record fields and axes.
  </dd>
  
  <dt id="layer"><span class="keyword"><code>layer:</code></span> <var>points</var> </dt>
  <dd>A list of points defining a layer in the plot</dd>

  <dt id="color"><span class="keyword"><code>color:</code></span> <var>name</var> | <var>"rgb"</var></dt>
  <dd>The color for drawing the specified plot list.</dd>

  <dt id="style"><span class="keyword"><code>style:</code></span> <var>name</var></dt>
  <dd>The style for drawing point records.
    <ul>
      <li> <code> envelope</code> (points connected by lines) </li>
      <li>  <code>line</code> (lines only) </li>
      <li>  <code>point</code> (points only) </li>
      <li>  <code>pianoroll</code> (horizontal boxes, requires 3 fields of data) </li>
      <li>  <code>impulse</code> (vertical lines) </li>
      <li>  <code>aerial</code> (vertical lines with points) </li>
      <li>  <code>bar</code> (vertical bars) </li>
    </ul>
  </dd>  
  
    <dt id="fields"><span class="keyword"><code>fields:</code></span>
  ((<var>field1 axis initval</var>)(<var>field2 axis initval</var>) <var>...</var>)</dt>
  <dd>
Defines the data fields of the points being displayed in the window. Field lists are requred for points with more than two fields of data and the left to right order of fields corresponds to the left-to-right values in the point records. (The standard 2-dimensional plots do not need to field definitions, they can simply specify global :xaxis and :yaxis for the window.). For each file, <var>name</var> is the name of the field 
    <var>axis</var> is its display axis definition as described in the  <a
  href="#xaxis">xaxis</a>  and <a href="#yaxis">yaxis</a> settings above and <var>initval</var> is the intial value of a field when a new point is created without an explicit value for that field. Fields can "share" the axis of a field to its left. For example in typical pianoroll plot the 3rd field (say, duration) shares the same axis as the first dimensino (seconds). To specify a shared axis use as its axis specificaion the field name of the field it should share with.</dd>

<!--
  <dt id="values"><span class="keyword"><code>values:</code></span> <span class="meta">{</span><var>int</var> | <code>y</code>}</dt>
  <dd>Specifies how to parse non-standard point
  lists, i.e. flat lists containing only y data or flat lists in which
  each series of <var>int</var> values should become a single
  point.</dd>
-->
  
</dl>

</blockquote>
<!-- END DEFINITION -->


<!-- DEFINITION -->
<table class="entry" id="plot-lists">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plot-lists(</span>
      (<var class="arg">lists</var>  <a href="#optkey">&amp;optkey</a> <var class="arg">yunits</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Opens a plot window and graphs one or more lists of data. values in each list of data are plotted on the y axis and equally spaced along the the x (percentage) axis. for best resuts the units of the data lists you pass in should be roughly the same. yunits determins the units of increment along the y axis. if this vale is not provided the function will determine a power of ten for the y axis increment. you can use other units as well, for example 12 would work for displaying key number data using the octave as the unit
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="plot-envelopes">
  <tr class="entry">
    <td class="formals">
      <span class="funcname">plot-envelopes</span>
      (<var class="arg">envs</var>, <a href="#optkey"> &amp;optkey</a><var class="arg">xunits</var> <var class="optval">= #f</var>, <var class="arg">yunits</var> <var class="optval">= #f</var>)
    </td>
    <!-- td class="label">Function</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
Opens a plot winow and graphs one or more envelops of data. the units of the envelopes you pass in should be the same.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="plot-data">
  <tr class="entry">
    <td class="formals">
    <span class="funcname">plot-data</span>
    (<var class="arg">title</var> <a href="#opt">&amp;opt</a> <var class="arg">all</var> <var class="optval">= #t</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p> Returns the point data from the plot window whose <var>title</var> is specified. If <var>all</var> is false then only the points in the topmost (focus) layer will be returned otherwise all layer data will be
returned.
</p>
</blockquote>
<!-- END DEFINITION -->

<!-- DEFINITION -->
<table class="entry" id="plot-hook">
  <tr class="entry">
    <td class="formals"> <span class="funcname">plot-hook</span>
      (<var class="arg">title</var>, <var class="arg">function</var>, <var class="rest">userdata...</var>)
    </td>
  </tr>
  <tr><td class="retval">&rarr; list</td></tr>
</table>
<blockquote>
<p>
Associates <var>function</var> with Control-Option-Mouseclick inside the plot window named <var>title</var>. When a Control-Option-Mouseclick occurs, <var>function</var> will be be called automatically and passed the X and Y values of the mouse click along with any additional values specified in  <var>userdata</var>. The  <var>function</var> (hook) should return a list of fully specified <a href="#point_record">point records</a> to add to the window, or an empty list if no points should be added.
</p>
</blockquote>
<!-- END DEFINITION -->

<h2 id="sal">SAL (version 2)</h2> 

<p>Sal is a minimalist language for algorithmic music composition. It provides <a href="#expressions">infix expressions</a> and a handful of control statements and reserved symbols:</p>

<!-- DEFINITION -->

<table> <!-- width="66%" -->
<tr>
<td>
<table>
<tr><td> <a href="#begin"><code>begin</code></a> </td></tr>
<tr><td> <a href="#loop"><code>below</code></a> </td></tr>
<tr><td> <a href="#loop"><code>by</code></a> </td></tr>
<tr><td> <a href="#if"><code>else</code></a> </td></tr>
<tr><td> <a href="#begin"><code>end</code></a> </td></tr>
<tr><td> <a href="#file"><code>file</code></a> </td></tr>
</table>
</td>

<td>
<table>
<tr><td> <a href="#loop"><code>finally</code></a> </td></tr>
<tr><td> <a href="#loop"><code>for</code></a> </td></tr>
<tr><td> <a href="#loop"><code>from</code></a> </td></tr>
<tr><td> <a href="#function"><code>function</code></a> </td></tr>
<tr><td> <a href="#if"><code>if</code></a> </td></tr>
<tr><td> <a href="#loop"><code>in</code></a> </td></tr>
</table>
</td>
<td>

<table>
<tr><td> <a href="#loop"><code>loop</code></a> </td></tr>
<tr><td> <a href="#define_process"><code>process</code></a> </td></tr>
<tr><td> <a href="#loop"><code>repeat</code></a> </td></tr>
<tr><td> <a href="#then"><code>then</code></a> </td></tr>
<tr><td> <a href="#loop"><code>to</code></a> </td></tr>
<tr><td> <a href="#loop"><code>unless</code></a> </td></tr>
</table>
</td>

<td>
<table>
<tr><td> <a href="#loop"><code>until</code></a> </td></tr>
<tr><td> <a href="#variable"><code>variable</code></a> </td></tr>
<tr><td> <a href="#wait"><code>wait</code></a> </td></tr>
<tr><td> <a href="#loop"><code>when</code></a> </td></tr>
<tr><td> <a href="#loop"><code>while</code></a> </td></tr>
<tr><td> <a href="#with"><code>with</code></a> </td></tr>
</table>
</td>

</tr>
</table>



<h3 id="expressions">Expressions</h3>

<dl>

<dt id="sal:numbers">Numbers</dt>
<dd>
  <p>SAL number representation includes integers, floats and ratios (e.g 1/2, 1/3, 11/17).</p>
</dd>

<dt id="sal:arithmetic">Arithmetic and Logical Expressions</dt>

<dd><p>Arithmetic and logical expressions are infix.  Operators must be delimited from their operands using spaces and/or parentheses (in other words, 2 + 4 is addition and 2+4 is nothing.) Standard operator
precedence rules apply if no parentheses are provided. The following math and logic operators are defined:
</p>
<table id="sal:operators" class= "float">
<tr><th class="lcol" style="padding-right: 1em;">operator</th><th class="lcol">meaning</th></tr>
<tr><td><code>  + </code></td><td>  addition  </td></tr>  
<tr><td><code>  - </code></td><td>  subtraction  </td></tr>  
<tr><td><code>  * </code></td><td>  multiplication  </td></tr>  
<tr><td><code>  / </code></td><td>  division  </td></tr>
<tr><td><code>  % </code></td><td>  modulus (remainder after division)  </td></tr>
<tr><td><code>  ^ </code></td><td>  exponentiation  </td></tr>
<tr><td><code>  = </code></td><td>  equal  </td></tr>
<tr><td><code>  != </code></td><td> not equal  </td></tr>
<tr><td><code>  &gt; </code></td><td>  greater than  </td></tr>
<tr><td><code>  &lt; </code></td><td>  less than  </td></tr>
<tr><td><code>  &gt;= </code></td><td> greater than or equal  </td></tr>
<tr><td><code>  &lt;= </code></td><td> less than or equal  </td></tr>
<tr><td><code>  ~= </code></td><td> general (looks like) equality </td></tr>
<tr><td><code>  &amp;  </code></td><td> logical and   </td></tr>
<tr><td><code>  |  </code></td><td> logical or  </td></tr>
<tr><td><code>  !  </code></td><td> logical not  </td></tr>
</table>
<p></p>
</dd>

<dt id="sal:conditionals">Booleans</dt>
<dd><p><code><span class="constant">#t</span></code> is boolean true and <code><span class="constant">#f</span></code> is boolean false.</p>
</dd>

<dt id="sal:conditional-values">Conditional Values</dt>
<dd><p><code><span class="salcon">#?</span> (<var class="arg">test</var>,  <var class="arg">true</var> <span class="meta">[</span><code>,</code> <var class="arg">false</var><span class="meta">]</span>)</code></p>
</dd>

<dt id="sal:strings">Strings</dt>
<dd><p>A string of uninterpreted characters enclosed within <code><span class="string">""</span></code>, e.g.  <code><span class="string">"Hi ho!"</span></code>.</p>
</dd>  

<dt id="sal:symbols">Symbols</dt>
<dd><p>Alphanumeric names for variables and functions, e.g. <code>foo</code> and <code>23-skidoo</code></p>
</dd>

<dt id="sal:keywords">Scheme Keywords (constants)</dt>
<dd>

 <p> <code><span class="constant">:<var class="arg">symbol</var></span></code>     </p>

</dd>

<dt id="sal:lists">Constant Lists</dt>
<dd><p>Sequences of data enclosed within <code>{}</code>, e.g. {1 2 3}. May contain numbers, booleans, symbols, strings, and other lists. Quasi-quotation in constant lists is supported. Use <code><span class="constant">#$</span></code> to unquote and <code><span class="constant">#^</span></code> to unquote-splice.</p>
</dd>

<!-- dt id="slot_ref">Slot value references</dt>
<dd><p>A variable reference <var>vvv</var>.<var>sss</var> where <var>vvv</var> is the name of the variable and <var>sss</var> is the name of a slot. Slot value references can appear in expressions and values can be assigned to slots by the <a href="#set">set</a> statement.</p></dd -->

<dt id="sal:array">List element notation</dt>
<dd>
  <p>A variable followed by an index inside <code>[]</code>, e.g. <code>foo[1]</code></p>
</dd>

<dt id="sal:funcall">Function call notation</dt>
<dd><p>A function name followed by zero or more comma-delimited arguments enclosed within <code>()</code>.</p>
</dd>
</dl>

<h3 id="assignment">Assignment</h3>


<!-- DEFINITION -->
<table class="entry" id="set">
  <tr class="entry">
    <td class="formals">
<!--      <span class="commandname">set</span> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var> <span class="meta">{</span><code>,</code> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var>}*</td> -->
      <span class="commandname">set</span> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var> <span class="meta">[</span><code>,</code> <var class="arg">variable</var> <var class="arg">op</var> <var class="arg">value</var> ...<span class="meta">]</span></td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>

Assigns each <var>variable</var> to <var>value</var> according to the assignment operator <var>op</var>:

</p>

<blockquote>
<table class= "float">
<tr><th class="lcol" style="padding-right: 1em;">operator</th><th class="lcol">meaning</th></tr>
<tr><td><code>=</code></td> <td> set <var>variable</var> to <var>value</var> </td> </tr>
<tr><td><code>+=</code></td> <td> increment <var>variable</var> by <var>value</var> </td> </tr>
<tr><td><code>*=</code></td> <td> scale <var>variable</var> by <var>value</var> </td> </tr>
<tr><td><code>&amp;=</code></td> <td> concatenate <var>value</var> onto the end of the list in <var>variable</var> </td> </tr>
<tr><td><code>^=</code></td> <td> splice the list <var>value</var> onto the end of the list in <var>variable</var> </td> </tr>
<tr><td><code>@=</code></td> <td> concatenate <var>value</var> onto the front of the list in <var>variable</var> </td> </tr>
<tr><td><code>&lt;=</code></td> <td> minimize <var>variable</var> with respect to <var>value</var> </td> </tr>
<tr><td><code>&gt;=</code></td> <td> maximize <var>variable</var> with respect to <var>value</var> </td> </tr>
</table>
</blockquote>
</blockquote>
<!-- END DEFINITION -->

<h3 id="conditionals">Conditionals</h3>

<!-- DEFINITION -->
<table class="entry" id="if">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">if</span>
      (<var class="arg">test</var>) ... <span class="meta">[</span><span class="commandname">else</span> ...<span class="meta">]</span>  <span class="commandname">end</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; value of last expression</td></tr>
</table>
<blockquote>
<p>
If <var>test</var> is true execute statements otherwise execute optional <var>else</var> statements. See also: <a href="#condval">conditional value</a>. Note that the parentheses around the <var>test</var> expression are required.
</p>
</blockquote>
<!-- END DEFINITION -->

<h3 id="sequencing">Sequencing</h3>

<!-- DEFINITION -->
<table class="entry" id="begin">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">begin</span> <span class="meta">[</span><span class="commandname">with</span> ...<span class="meta">]</span> ... <span class="commandname">end</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; value of last expression</td></tr>
</table>
<blockquote>
<p>
Sequences one or more SAL statements as a single statement. The optional <a href="#with"><span class="commandname">with</span></a> statement is a local variable declaration that can appear at the start of block statements like <a href="#begin"><code>begin</code></a>, <a href="#loop"><code>loop</code></a>, <a href="#function"><code>function</code></a> and <a href="#process"><code>process</code></a>:
</p>


<!-- DEFINITION -->
<table class="entry" id="with">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">with</span> <var class="arg">var</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span> <span class="meta">{</span>, <var class="arg">var</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span><span class="meta">}*</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>which will
Define one or more local variables (within the surrounding block), optionally setting inital values to <var>expr</var> (or to false if <var>expr</var> is not provided).
</p>
</blockquote>
</blockquote>
<!-- DEFINITION -->

<h3 id="definitions">Definitions</h3>

<!-- DEFINITION -->
<table class="entry" id="variable">
  <tr class="entry">
    <td class="formals">
       <span class="commandname">variable</span>
<var class="arg">var</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span> <span class="meta">{</span>, <var class="arg">var</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span><span class="meta">}*</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; value of last expression</td></tr>
</table>
<blockquote>
<p> Defines one or more variables as "global" within the current context.
</p>

</blockquote>
<!-- END DEFINITION [arg [, arg] ... [&optkey arg [= expr] [, arg [= [expr]]] ...]]
<span class="meta">[</span><var class="arg">arg</var> <span class="meta">[</span>, <var class="arg">arg</var><span class="meta">]</span> ... <span class="meta">[</span><span class="reserved">&optkey</span> <var class="arg">arg</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span> <span class="meta">[</span>, <var class="arg">arg</var> <span class="meta">[</span>= <var class="arg">expr</var><span class="meta">]</span><span class="meta">]</span> ...<span class="meta">]</span><span class="meta">]</span>
 -->

<!-- DEFINITION -->
<table class="entry" id="function">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">function</span> <var class="arg">name</var> (<span class="meta">{</span><var class="arg">parameters</var><span class="meta">}*</span>) <span class="meta">[</span><span class="commandname">with</span> ...<span class="meta">]</span> <span class="meta">{</span><var class="arg">statement</var><span class="meta">}+</span> <span class="commandname">end</span>
    </td>
    <!-- td class="label">SAL</td -->
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
A function definition consists of the <var>name</var> of the function,
a parameter list containing zero or more <var>required parameters</var> optionally followed by <code><span class="reserved">&amp;optkey</span></code> and any <a href="#optkey_arguments">optkey argument</a>.
Following the parameter list comes the statements to be executed when the function is called. The first of these statements can be a <a href="#with">with</a> declaration.
The last statement in the body of the function becomes the value of the function call.
</p>
</blockquote>

<!-- END DEFINITION -->

<h3 id="files">Files</h3>

<!-- DEFINITION -->

<table class="entry" id="file">
  <tr class="entry">
    <td class="formals">
      <span class="commandname">file</span> "<var class="arg">file.ext</var>" (<span class="meta">{</span><var class="arg">keyword value</var><span class="meta">}*</span>) <span class="meta">[</span><span class="commandname">with</span> ...<span class="meta">]</span> <span class="meta">{</span><var class="arg">statement</var><span class="meta">}+</span> <span class="commandname">end</span>
    </td>
  </tr>
  <tr><td class="retval">&rarr; void</td></tr>
</table>
<blockquote>
<p>
A score file definition. The string "<var>file.ext</var>" is the pathname of the file to create, where <var>file</var> can include a directory component and <var>ext</var> must be one of the <a href="#score_file_types">supported score file types</a>. Following the name of the file comes zero or more keyword options as suitable for the type of file being created. Inside the body of <code>file</code> you can write any expressions that send data to the currently open score file.
</p>
</blockquote>

<h2 id="appendix">Appendix</h2>


<h3 id="metasyntax">A. Documentation Meta-syntax</h3>
<ul>

<li>
Definition terms are printed in fixed-width bold face:
<blockquote>
<p><code class="entry">cents-&gt;scaler</code></p>
</blockquote>
</li>

<li>
Literals and programming code are printed in fixed-width face:
<blockquote>
<p><code>list(note(60), rhythm(<span class="string">"h."</span>))</code></p>
</blockquote>
</li>

<li>
Variables and metavariables (names that stand for pieces of code) are printed in italic face:
<blockquote>
<p><var>number</var></p>
</blockquote>
</li>

<li>Terms separated by | are exclusive choices where exactly one must apply:
<blockquote>
<p><var>number</var> | <var>boolean</var></p>
</blockquote>
</li>

<li>
<p>Braces <span class="meta">{ }</span> and brackets <span class="meta">[ ]</span> are sometimes used to associate or group
the enclosed terms and are not part of actual code.
</p>
<ul>
<li>
Braces group the enclosed terms into a single entity. Thus:
<blockquote>
<p><span class="meta">{</span><var>number</var> | <var>boolean</var><span class="meta">}</span></p>
</blockquote>
<p>describes single value that is either a number or a boolean.</p>
</li>

<li>
Brackets make the enclosed term optional. An optional term may appear
at most one time. For example, in the following definition:

<blockquote>
<p>
<code></code><code class="entry">odds</code>(<var>prob</var> <span class="meta">[</span>,<var>trueval</var><span class="meta">]</span> <span class="meta">[</span>,<var>falseval</var><span class="meta">]</span><code>)</code>
</p>
</blockquote>
<var>prob</var> is a required argument that may be followed by up to
two optional values. Thus, each of the following calls is correct: 
<blockquote>
<pre>odds(.5)
odds(1, <span class="constant">#t</span>)
odds(.2, <span class="string">"Yup"</span>, <span class="string">"Nope"</span>)</pre>
</blockquote>
</li>

</ul>
</li>

<li>
A star <span class="meta">*</span> after a brace means that the enclosed terms may be specified
zero or more times. For example:
<blockquote>
<p>
<code> <span class="meta">{</span><var>keyword value</var><span class="meta">}*</span></code>
</p>
</blockquote>

means that any number of <var>keyword</var> and <var>value</var> pairs,
including none, may be specified.
</li>

<li>
<p>A plus <span class="meta">+</span> after a brace means that the enclosed terms may be specified one or more times.</p>
</li>

<li>
A sequence of three dots means the rest of the arguments, no matter how many. For example:

<blockquote>
<p>
<code>pick(<var>arg ...</var>)</code>
</p>
</blockquote>
means that any number of additional values, including none, may
follow <var>arg</var>.
</li>

<li>Syntax highlighting distinguishes important syntactic units:

<blockquote>
<table> <!--  cellspacing="10"width="90%" -->
<tr><th >keyword</th><th>string</th>  <th >constant</th>  <th >reserved</th><th >comment</th></tr>
<tr><td style="text-align:center;"><code><span class="keyword">music:</span></code></td>
    <td style="text-align:center;"><code><span class="string">"Hello, world"</span></code></td>
    <td style="text-align:center;"><code><span class="constant">#t</span></code></td>
    <td style="text-align:center;"><code><span class="reserved">loop</span></code></td><td><code><span class="comment">;; bug!</span></code></td></tr>
</table>
</blockquote>
</li>
</ul>


<h3 id="funargs">B. Function Arguments</h3>

<p>Several different types of function arguments are supported:
</p>

<dl >
<dt id="sal:required-parameters"><span style="font-weight:bold">Required arguments</span></dt>
<dd>
  <p>
  Required arguments must be specified, that is, each required argument must have an explicit value provided in the function call.
</p>
</dd>

<dt id="sal:optional-parameters"><span id="opt" style="font-weight:bold">Optional arguments</span></dt>
<dd>
  <p>
  Optional arguments may be specified or not.  If not, they receive a default value, which is #f (false) if not otherwise indicated.
</p>
</dd>

<dt id="sal:optkey-parameters"><span id="optkey" style="font-weight:bold">Optional/keyword arguments</span></dt>
<dd>
  <p>
  Opt/key arguments are optional arguments that can be specified positionally or by preceding the argument value by its keyword name. In Scheme keyword argument names start with a colon and in SAL they end with a colon. For example, if a function <code>foo</code> has two opt/key arguments <var>a</var> and <var>b</var> then in SAL the function could be called in any of the following ways:</p>

<code>foo() foo(4) foo(2,3) foo(a: 3) foo(b: 99) foo(a: 2, b: 4) foo(b: 99, a: 2)</code>   

<p> and in Scheme:</p>

<code>(foo) (foo 4) (foo 2 3) (foo :a 3) (foo :b 99) (foo :a 2 :b 4) (foo :b 99 :a 2)</code>   

<p></p>
</dd>

<dt id="sal:variable-parameters"><span id="restarg" style="font-weight:bold">Variable arguments</span></dt>
<dd>
  <p>
  A variable argument takes zero or more values.  A variable argument is shown in the documentation as <code><var class="rest">...</var></code> which means 'the rest of the arguments'.
</p>
</dd>
</dl>

<!-- EXAMPLES -->

<h3 id="sal_scheme_cltl">C. Table of SAL, Scheme and Common Lisp</h3>

<table>
  <caption>A. Translation table for SAL, Scheme and Common Lisp entities.
</caption>
  <thead>
  <tr>
    <th> </th>
    <th class="headingth">
      SAL
    </th>
    <th class="headingth" >

      Scheme <a href="#foot1"><span class="footnoteref">1</span></a>
    </th>
    <th class="headingth" >
      Common Lisp <a href="#foot2"><span class="footnoteref">2</span></a>
    </th>
  </tr>
  </thead>

  <tbody>

  <!-- Booleans -->
  <tr>    
    <th class="headingth">Booleans</th>
    <td class="saltd">
      #f
    </td>
    <td class="schemetd">

      #f
    </td>
    <td class="cltltd">
      nil
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      #t
    </td>

    <td class="schemetd">
      #t
    </td>
    <td class="cltltd">
      t
    </td>
  </tr>

  <!-- Keywords -->
  <tr>    
    <th class="headingth">Keywords</th>

    <td class="saltd">
      foobar:
    </td>
    <td class="schemetd">
      #:foobar <var>or</var> :foobar
    </td>
    <td class="cltltd">
      :foobar
    </td>
  </tr>

  <!-- Empty List -->
  <tr>    
    <th class="headingth">Lists</th>
    <td class="saltd">
      {}
    </td>
    <td class="schemetd">
      '()
    </td>

    <td class="cltltd">
      ()  <var>or</var> nil
    </td>
  </tr>

  <!-- Constant Lists -->
  
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      {a b {1 2 3} c}
    </td>
    <td class="schemetd">
      '(a b (1 2 3) e)
    </td>
    <td class="cltltd">
      '(a b (1 2 3) e)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      {a #$ ran(100) c}
    </td>
    <td class="schemetd">
      `(a ,(random 100) c}
    </td>
    <td class="cltltd">
      `(a ,(random 100) c)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      {a #^ list(ran(100), ran(100)) c}
    </td>
    <td class="schemetd">
      `(a ,@ (list (random 100) (random 100)) c}
    </td>
    <td class="cltltd">
      `(a ,@(list (random 100) (random 100)) c)
    </td>
  </tr>
 
  <!-- Arithmetic -->

  <tr>    
    <th class="headingth">Arithmetic</th>
    <td class="saltd">
      1 + 2
    </td>
    <td class="schemetd">
      (+ 1 2)
    </td>

    <td class="cltltd">
      (+ 1 2)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      - 1
    </td>

    <td class="schemetd">
      (- 1)
    </td>
    <td class="cltltd">
      (- 1)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">

      1 + 2 + 3 * 4
    </td>
    <td class="schemetd">
      (+ 1 2 (* 3 4))
    </td>
    <td class="cltltd">
      (+ 1 2 (* 3 4))
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>

    <td class="saltd">
      3 ^ 4
    </td>
    <td class="schemetd">
      (expt 3 4)
    </td>
    <td class="cltltd">
      (expt 3 4)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      3 % 4
    </td>
    <td class="schemetd">
      (modulo 3 4)
    </td>
    <td class="cltltd">
      (mod 3 4)
    </td>

  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a = b
    </td>
    <td class="schemetd">
      (= a b)
    </td>
    <td class="cltltd">

      (= a b)
    </td>
  </tr>
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a / b != b * c
    </td>
    <td class="schemetd">
      (not (= (/ a b) (* b c)))
    </td>

    <td class="cltltd">
      (/= (/ a b) (* b c))
    </td>
  </tr>

    <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      a ~= b
    </td>
    <td class="schemetd">
      (equal a b)
    </td>

    <td class="cltltd">
      (equal a b)
    </td>
  </tr>

  <!-- Logic -->

  <tr>    
    <th class="headingth">Logic </th>
    <td class="saltd">
      a | b
    </td>

    <td class="schemetd">
      (or a b)
    </td>
    <td class="cltltd">
      (or a b)
    </td>
  </tr>
  <tr>
    <th class="headingth"> </th>

    <td class="saltd">
      ! a | b
    </td>
    <td class="schemetd">
      (or (not a) b)
    </td>
    <td class="cltltd">
      (or (not a) b)
    </td>
  </tr>

  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      a &amp; b | ! c
    </td>
    <td class="schemetd">
      (or (and a b) (not c))
    </td>
    <td class="cltltd">

      (or (and a b) (not c))
    </td>
  </tr>

  <!-- Function calls -->

  <tr>    
    <th class="headingth">Function calls</th>

    <td class="saltd">
      list()
    </td>
    <td class="schemetd">
      (list)
    </td>
    <td class="cltltd">
      (list)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      list(10)
    </td>
    <td class="schemetd">
      (list 10)
    </td>
    <td class="cltltd">
      (list 10)
    </td>
  </tr>

  <tr>
    <th class="headingth"></th>
    <td class="saltd">
      list(1, 2 + 3, 4)
    </td>
    <td class="schemetd">
      (list 1 (+ 2 3) 4)
    </td>
    <td class="cltltd">

      (list 1 (+ 2 3) 4)
    </td>
  </tr>

  <tr>
    <th class="headingth"></th>
    <td class="saltd">
      list(1, 2, random(10))
    </td>
    <td class="schemetd">

      (list 1 2 (random 10))
    </td>
    <td class="cltltd">
      (list 1 2 (random 10))
    </td>
  </tr>

  <!-- Conditionals -->

  <tr>
    <th class="headingth"> Conditionals</th>
    <td class="saltd">
      if (a = b)<br/>&nbsp;&nbsp;list(1,2)<br/>else<br/>&nbsp;&nbsp;list(3,4)<br/>end
    </td>
    <td class="schemetd">
      (if (= a b)<br/>&nbsp;&nbsp;(list 1 2)<br/>&nbsp;&nbsp;(list 3 4))
    </td>
    <td class="cltltd">
      (if (= a b)<br/>&nbsp;&nbsp;(list 1 2)<br/>&nbsp;&nbsp;(list 3 4))
    </td>
  </tr>
  
  <tr>
    <th class="headingth"> </th>
    <td class="saltd">
      #?(a = b, -99, 2)
    </td>
    <td class="schemetd">

      (if (= a b) -99 2)
    </td>
    <td class="cltltd">
      (if (= a b) -99 2)
    </td>
  </tr>

  <!-- Global Variables -->

  <tr>    
    <th class="headingth">Global variables</th>

    <td class="saltd">
      variable a
    </td>
    <td class="schemetd">
      (define a #f)
    </td>
    <td class="cltltd">
      (defparameter a nil)
    </td>
  </tr>

  <!-- Function Definitions -->

  <tr>    
    <th class="headingth">Function definitions </th>
    <td class="saltd">
      function foo (a)<br/>
      &nbsp;&nbsp;a + ran(10)<br/>
      end
    </td>
    <td class="schemetd">

      (define (foo a)<br/>
      &nbsp;&nbsp;(+ a (random 10)))
    </td>
    <td class="cltltd">
      (defun foo (a)<br/>
      &nbsp;&nbsp;(+ a (random 10)))
    </td>
  </tr>

  <!-- Code blocks 1 -->
  <tr>    
    <th class="headingth">Code blocks</th>
    <td class="saltd">
      begin<br/>
      &nbsp;&nbsp;...<br/>
      end
    </td>

    <td class="schemetd">
      (begin<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
    <td class="cltltd">
      (progn<br/>
      &nbsp;&nbsp;...<br/>

      &nbsp;&nbsp;)
    </td>
  </tr>


 <!-- Code blocks 2 -->

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      begin<br/>
      &nbsp;&nbsp;with a = 1, b = a + 2<br/>
      &nbsp;&nbsp;...<br/>
      end
    </td>

    <td class="schemetd">
      (let* ((a 1)<br/>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b (+ a 2))<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
    <td class="cltltd">
      (let* ((a 1)<br/>

      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b (+ a 2))<br/>
      &nbsp;&nbsp;...<br/>
      &nbsp;&nbsp;)
    </td>
  </tr>




  
  <!-- Assignment 1 -->
  <tr>    
    <th class="headingth"> Assignment</th>
    <td class="saltd">
      set a = 123
    </td>
    <td class="schemetd">
      (set! a 123)
    </td>

    <td class="cltltd">
      (setf a 123)
    </td>
  </tr>

  <!-- Assignment 2 -->
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a = 123, b = a
    </td>

    <td class="schemetd">
      (set! a 123)<br/>
      (set! b a)
    </td>
    <td class="cltltd">
      (setf a 123 b a)
    </td>
  </tr>

  <!-- Assignment 3 -->

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a += 123
    </td>
    <td class="schemetd">
      (set! a (+ a 123))
    </td>
    <td class="cltltd">
      (incf a 123)
    </td>

  </tr>

  <!-- Assignment 4 -->
  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a *= 123
    </td>
    <td class="schemetd">
      (set! a (* a 123))
    </td>

    <td class="cltltd">
      (setf a (* a 123))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &amp;= 123
    </td>
    <td class="schemetd">
      (set! a (append a (list 123)))
    </td>

    <td class="cltltd">
      (setf a (append a (list 123)))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a @= 123
    </td>
    <td class="schemetd">
      (set! a (cons 123 a))
    </td>

    <td class="cltltd">
      (push 123 a)
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &lt;= 123
    </td>
    <td class="schemetd">
      (set! a (min 123 a))
    </td>

    <td class="cltltd">
      (setf a (min 123 a))
    </td>
  </tr>

  <tr>    
    <th class="headingth"> </th>
    <td class="saltd">
      set a &gt;= 123
    </td>
    <td class="schemetd">
      (set! a (max 123 a))
    </td>

    <td class="cltltd">
      (setf a (max 123 a))
    </td>
  </tr>


  <!-- Iteration -->
  <tr>    
    <th class="headingth">Iteration </th>
    <td class="saltd">
      loop ... end
    </td>
    <td class="schemetd">
      (loop ...)
    </td>

    <td class="cltltd">
      (loop ... )
    </td>
  </tr>
  <!--  TABLE FOOTER -->
  <tr>
    <td> </td>
    <td colspan="3" id="foot1">1. Reference Scheme implementation: <a href="http://www.call-with-current-continuation.org/">Chicken Scheme</a>
    </td>
  </tr>

  <tr>
    <td> </td>
    <td colspan="3" id="foot2">2. Reference Common Lisp: <a href="http://sbcl.sourceforge.net">Steel Bank Common Lisp (SBCL)</a>
    </td>
  </tr>

  </tbody>

</table>    


<h2 id="index">Index</h2>

<h4>b</h4>
<p>
<a href="#between">between</a>,
<a href="#butlast">butlast</a>
</p>

<h4>c</h4>

<p>
<a href="#cell-state">cell-state</a>,
<a href="#cents-_ratio">cents-&gt;ratio</a>
, <a href="#chdir">chdir</a>,
<a href="#concat">concat</a>,
<a href="#cont">cont</a>,
<a href="#cs:event">cs:event</a>,
<a href="#cs:f">cs:f</a>,
<a href="#cs:i">cs:i</a>
</p>

<h4>d</h4>

<p>
<a href="#decimals">decimals</a>,
<a href="#deltas">deltas</a>,
<a href="#directory">directory</a>,
<a href="#discrete">discrete</a>,
<a href="#divide">divide</a>,
<a href="#drunk">drunk</a>
</p>

<h4>e</h4>

<p>
<a href="#elapsed">elapsed</a>,
<a href="#envelope-average">envelope-average</a>,
<a href="#envelope-_list">envelope-&gt;list</a>,
<a href="#envelope-max">envelope-max</a>,
<a href="#envelope-min">envelope-min</a>,
<a href="#eod_">eod?</a>,
<a href="#eop_">eop?</a>
</p>

<h4>f</h4>

<p>
<a href="#file-version">file-version</a>,
<a href="#first">first</a>,
<a href="#fit">fit</a>,
<a href="#fm-spectrum">fm-spectrum</a>,
<a href="#fms:clear-score">fms:clear-score</a>,
<a href="#fms:delete-score">fms:delete-score</a>,
<a href="#fms:inst">fms:inst</a>,
<a href="#fms:load-score">fms:load-score</a>,
<a href="#fms:mark">fms:mark</a>,
<a href="#fms:meas">fms:meas</a>,
<a href="#fms:measdef">fms:measdef</a>,
<a href="#fms:merge-score">fms:merge-score</a>,
<a href="#fms:metapart">fms:metapart</a>,
<a href="#fms:new-score">fms:new-score</a>,
<a href="#fms:note">fms:note</a>,
<a href="#fms:part">fms:part</a>,
<a href="#fms:percinst">fms:percinst</a>,
<a href="#fms:rest">fms:rest</a>,
<a href="#fms:run">fms:run</a>,
<a href="#fms:save-score">fms:save-score</a>,
<a href="#fms:select-score">fms:select-score</a>,
<a href="#fms:setting">fms:setting</a>
</p>

<h4>g</h4>

<p>
<a href="#greater_eqm">greater=?</a>,
<a href="#greater_qm">greater?</a>
</p>

<h4>h</h4>

<p>
<a href="#harmonics">harmonics</a>,
<a href="#hertz">hertz</a>
</p>

<h4>i</h4>

<p>
<a href="#in-tempo">in-tempo</a>,
<a href="#interp">interp</a>,
<a href="#interp-envelopes">interp-envelopes</a>,
<a href="#invert">invert</a>,
<a href="#invert-envelope">invert-envelope</a>
</p>

<h4>k</h4>
<p>
<a href="#keynum">keynum</a>
</p>

<h4>l</h4>

<p>
<a href="#last">last</a>,
<a href="#less_eqm">less=?</a>,
<a href="#less_qm">less?</a>,
<a href="#list-difference">list-difference</a>,
<a href="#list-intersection">list-intersection</a>,
<a href="#list-set_">list-set!</a>,
<a href="#list-union">list-union</a>,
<a href="#list-_envelope">list-&gt;envelope</a>,
<a href="#load">load</a>,
<a href="#log10">log10</a>,
<a href="#log2">log2</a>
</p>

<h4>m</h4>
<p>
<a href="#make-automata">make-automata</a>,
<a href="#make-cycle">make-cycle</a>,
<a href="#make-graph">make-graph</a>,
<a href="#make-heap">make-heap</a>,
<a href="#make-list">make-list</a>,
<a href="#make-markov">make-markov</a>,
<a href="#make-palindrome">make-palindrome</a>,
<a href="#make-repeater">make-repeater</a>,
<a href="#make-rotation">make-rotation</a>,
<a href="#make-spectrum">make-spectrum</a>,
<a href="#make-weighting">make-weighting</a>,
<a href="#markov-analyze">markov-analyze</a>,
<a href="#midifile-header">midifile-header</a>,
<a href="#midifile-import">midifile-import</a>,
<a href="#minus">minus</a>,
<a href="#most-negative-fixnum">most-negative-fixnum</a>,
<a href="#most-positive-fixnum">most-positive-fixnum</a>,
<a href="#mouse-button">mouse-button</a>,
<a href="#mouse-x">mouse-x</a>,
<a href="#mouse-y">mouse-y</a>,
<a href="#mp:bend">mp:bend</a>,
<a href="#mp:ctrl">mp:ctrl</a>,
<a href="#mp:inchans">mp:inchans</a>,
<a href="#mp:inops">mp:inops</a>,
<a href="#mp:instruments">mp:instruments</a>,
<a href="#mp:midi">mp:midi</a>,
<a href="#mp:off">mp:off</a>,
<a href="#mp:on">mp:on</a>,
<a href="#mp:press">mp:press</a>,
<a href="#mp:prog">mp:prog</a>,
<a href="#mp:receive">mp:receive</a>,
<a href="#mp:receive_qm">mp:receive?</a>,
<a href="#mp:touch">mp:touch</a>
</p>

<h4>n</h4>

<p>
<a href="#next">next</a>,
<a href="#normalize-envelope">normalize-envelope</a>,
<a href="#note">note</a>,
<a href="#now">now</a>,
<a href="#nth">nth</a>
</p>

<h4>o</h4>

<p>
<a href="#odds">odds</a>,
<a href="#osc:bundle">osc:bundle</a>,
<a href="#osc:close">osc:close</a>,
<a href="#osc:message">osc:message</a>,
<a href="#osc:open">osc:open</a>,
<a href="#osc:receive">osc:receive</a>,
<a href="#osc:receive_qm">osc:receive?</a>
</p>

<h4>p</h4>

<p>
<a href="#pause">pause</a>,
<a href="#pitch-class">pitch-class</a>,
<a href="#pi">pi</a>,
<a href="#pick">pick</a>,
<a href="#plot">plot</a>,
<a href="#plot-data">plot-data</a>,
<a href="#plot-envelopes">plot-envelopes</a>,
<a href="#plot-hook">plot-hook</a>,
<a href="#plot-lists">plot-lists</a>,
<a href="#plus">plus</a>,
<a href="#print">print</a>,
<a href="#promise">promise</a>,
<a href="#pwd">pwd</a>
</p>

<h4>q</h4>

<p>
<a href="#quantize">quantize</a>,
<a href="#qsort_">qsort!</a>
</p>

<h4>r</h4>

<p>
<a href="#ran">ran</a>,
<a href="#ranbeta">ranbeta</a>,
<a href="#ranbrown">ranbrown</a>,
<a href="#rancauchy">rancauchy</a>,
<a href="#random-seed">random-seed</a>,
<a href="#random-series">random-series</a>,
<a href="#ranexp">ranexp</a>,
<a href="#rangamma">rangamma</a>,
<a href="#rangauss">rangauss</a>,
<a href="#ranhigh">ranhigh</a>,
<a href="#ranlow">ranlow</a>,
<a href="#ranmiddle">ranmiddle</a>,
<a href="#ranpink">ranpink</a>,
<a href="#ranpoisson">ranpoisson</a>,
<a href="#ratio-_cents">ratio-&gt;cents</a>,
<a href="#ratio-_steps">ratio-&gt;steps</a>,
<a href="#read-envelope">read-envelope</a>,
<a href="#rescale">rescale</a>,
<a href="#remove-duplicates">remove-duplicates</a>,
<a href="#rest">rest</a>,
<a href="#rest_qm">rest?</a>,
<a href="#retrograde">retrograde</a>,
<a href="#reverse-envelope">reverse-envelope</a>, 
<a href="#rhythm">rhythm</a>,
<a href="#rm-spectrum">rm-spectrum</a>
</p>

<h4>s</h4>

<p>
<a href="#scale">scale</a>,
<a href="#scale-order">scale-order</a>,
<a href="#sdif-import">sdif-import</a>,
<a href="#sdif-import-spectra">sdif-import-spectra</a>,
<a href="#segs">segs</a>,
<a href="#shell">shell</a>,
<a href="#shuffle">shuffle</a>,
<a href="#shuffle_">shuffle!</a>,
<a href="#spear-export-spectra">spear-export-spectra</a>,
<a href="#spear-import-spectra">spear-import-spectra</a>,
<a href="#spectrum-add_">spectrum-add!</a>,
<a href="#spectrum-amps">spectrum-amps</a>,
<a href="#spectrum-copy">spectrum-copy</a>,
<a href="#spectrum-flip_">spectrum-flip!</a>,
<a href="#spectrum-freqs">spectrum-freqs</a>,
<a href="#spectrum-invert_">spectrum-invert!</a>,
<a href="#spectrum-keys">spectrum-keys</a>,
<a href="#spectrum-maxamp">spectrum-maxamp</a>,
<a href="#spectrum-maxfreq">spectrum-maxfreq</a>,
<a href="#spectrum-minamp">spectrum-minamp</a>,
<a href="#spectrum-minfreq">spectrum-minfreq</a>,
<a href="#spectrum-pairs">spectrum-pairs</a>,
<a href="#spectrum-rescale_">spectrum-rescale!</a>,
<a href="#spectrum-size">spectrum-size</a>,
<a href="#spectrum-time">spectrum-time</a>,
<a href="#sprout">sprout</a>,
<a href="#sprout-hook">sprout-hook</a>,
<a href="#state">state</a>,
<a href="#stop">stop</a>
</p>

<h4>t</h4>

<p>
<a href="#tail">tail</a>,
<a href="#tendency">tendency</a>,
<a href="#times">times</a>,
<a href="#transpose">transpose</a>
</p>

<!--
<h4>u</h4>
<p>
<a href="#unique">unique</a>
</p>
-->

<h4>v</h4>

<p>
<a href="#vary">vary</a>
</p>

<h4>x</h4>
<p>
<a href="#xy">xy</a>
</p>

<hr/>
<p><!-- hhmts start -->Last modified: Mon May 15 13:47:18 CDT 2017 <!-- hhmts end --></p>

</div>
</body>
</html>

